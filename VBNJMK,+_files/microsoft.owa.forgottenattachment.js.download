window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.forgottenattachment.js'] = (new Date()).getTime();
Type.registerNamespace("_fa");_fa.d=function(){};_fa.d.registerInterface("_fa.d");function ForgottenAttachmentComponent(){}ForgottenAttachmentComponent.$$cctor=function(){_a.t.a().a(ForgottenAttachmentComponent)};ForgottenAttachmentComponent.prototype={b:function(n,t,i){n.e(_fa.a).b(_fa.d).a();var r=this;n.b(_fa.c,function(){return new _fa.c(n.a(_fa.d),n.a(_g.h),n.a(_a.q))}).b(_y.dV).a()},a:function(){return null}};_fa.e=function(n,t){_fa.e.initializeBase(this,[1,"ForgottenAttachment.AttachmentEvent"]);this.b(n);this.c(t)};_fa.e.prototype={b:function(n){this.a.Event=n;return n},c:function(n){this.a.RuleNum=n;return n}};_fa.b=function(n,t,i,r,u){this.k=Function.createDelegate(this,this.l);this.e=n;this.j=t;this.b=i;this.d=r;this.g=u;this.f=r.a().bH.CheckForForgottenAttachments};_fa.b.prototype={e:null,j:null,d:null,g:null,b:null,h:!1,c:null,f:!1,i:!1,a:function(n,t){if(!this.f||this.i)return!1;var o=!1;if(!t){t=n.eE();o=!0}if(n.cV()){n.cV().a();var u=!1;if(t)if(o)u=t.b()>0;else for(var i=0;i<t.b();i++){var h=t.c(i);if(!h.c()){u=!0;break}}var s=n.eF()==="HTML";if(u||s&&this.m(n.cU()))this.h&&this.b.a(2,this.c);else{var r;var f,e;if(e=this.b.b(n.H(),n.cU(),s,this.d.c().bH.UserCulture,f={val:r}),r=f.val,e){this.c=r;this.h=!0;this.e.h(1,[_nbs.a.pn],this.k,!0,_nbs.a.VA,_nbs.a.rY,_nbs.a.Pn,this.e.z,null,null,null);return!0}}}return!1},l:function(n,t){if(t){this.d.a().bq(!1);_h.f.a(this.d.a().u,this.g);this.b.a(3,this.c);this.f=!1}if(n){this.i=!0;this.b.a(0,this.c);this.j.a()}else this.b.a(1,this.c)},m:function(n){var u=document.createElement("div");var t=$(u);t.html(n);t.find("#divRplyFwdMsg").nextAll().remove();var r=String.format('img[src*="{0}"]',_fa.b.a);var i=t.find(r).first();return i.size()>0}};_fa.c=function(n,t,i){this.c=n;this.d=t;this.b=i};_fa.c.prototype={c:null,d:null,b:null,a:function(n,t){return new _fa.b(n,t,this.c,this.d,this.b)}};_fa.a=function(){};_fa.a.$$cctor=function(){_fa.a.a={};_fa.a.a.en=!0};_fa.a.b=function(n){return typeof window.NLG!="undefined"&&typeof window.Microsoft_NaturalLanguage_AttachmentRes!="undefined"&&!!window.Microsoft_NaturalLanguage_AttachmentRes[n]};_fa.a.c=function(n){return n.substr(0,2)};_fa.a.prototype={b:function(n,t,i,r,u){u.val=null;if(!r||r.length<2)return!1;t||(t="");n||(n="");var e=_fa.a.c(r);if(!_fa.a.b(e))return!1;var h=_a.b.b(_a.a.p,"ForgottenAttachment.Start",!1,null);var o=this.c();var s=i?NLG.b.b(t):t;var f=new NLG.c;f.a=NLG.b.a(s,e);f.b=n;u.val=o.b(f,e);_a.b.a(h);return u.val.b},a:function(n,t){_a.g.l.b(new _fa.e(n,t.c))},c:function(){return new NLG.FAD.a}};ForgottenAttachmentComponent.registerClass("ForgottenAttachmentComponent",null,_a.kd,_j.ce);_fa.e.registerClass("_fa.e",_a.bs);_fa.c.registerClass("_fa.c",null,_y.dV);_fa.a.registerClass("_fa.a",null,_fa.d,IForgottenAttachmentImplementation);ForgottenAttachmentComponent.$$cctor();_fa.b.a=String.format("service.svc/s/GetFileAttachment?id={0}","");_fa.a.a=null;_fa.a.$$cctor();
window.scriptsLoaded['microsoft.owa.forgottenattachment.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.forgottenattachment.js'] = (new Date()).getTime();
