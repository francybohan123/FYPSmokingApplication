window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.linkpreview.js'] = (new Date()).getTime();
Type.registerNamespace("_lp");_lp.d=function(){};_lp.d.a=function(){return _fm.d.a("play.png")};_lp.d.b=function(){return _fm.d.a("play_filled.png")};_lp.d.f=function(){return _fm.b.a(_fm.a.fd,_fm.WebfontSizes.a.a)};_lp.d.e=function(){return _fm.b.a(_fm.a.fe,_fm.WebfontSizes.a.a)};_lp.d.d=function(){return _fm.b.a(_fm.a.A,_fm.WebfontSizes.a.b)};_lp.d.c=function(){return _fm.b.a(_fm.a.fa,_fm.WebfontSizes.a.b)};_lp.a=function(n,t,i,r,u,f,e,o){this.bv=Function.createDelegate(this,this.cK);this.bu=Function.createDelegate(this,this.cJ);this.bt=Function.createDelegate(this,this.cI);this.br=Function.createDelegate(this,this.cG);this.bw=Function.createDelegate(this,this.cT);this.bs=Function.createDelegate(this,this.cH);this.G=Function.createDelegate(this,this.bK);this.U=Function.createDelegate(this,this.cS);this.T=Function.createDelegate(this,this.cR);this.bq=Function.createDelegate(this,this.ci);this.bp=Function.createDelegate(this,this.ch);this.y={};this.bj=n;this.bd=t;this.bM=r;this.M="Mouse"===r.a();this.ba=i;this.F=u;this.O=f;this.X=e;this.bf=o;this.bb=this.F.a().fF().Enabled;this.R=this.z("ms-font-color-neutralSecondary ms-bg-color-themeLighterAlt",["color","background-color"]);this.be=this.z("ms-font-color-neutralDark ms-bg-color-themeLight",["color","background-color"])};_lp.a.c=function(n,t,i,r){var u=!1;try{n.src=t;_lp.a.k(n);u=!0}catch(f){_j.e.c(_a.a.f,"Setting src in {0}. Exception: {1} Url: {2} ImageUrl: {3}",r,f.message,i,t)}return u};_lp.a.a=function(n){var t=_a.d.get_utcNow().w().toString()+Math.random();return n+"_"+t};_lp.a.k=function(n){if(n.src.startsWith(_lp.a.j)){n.className="EmojiInsert";n.alt="imageData"+_lp.a.o()}};_lp.a.o=function(){return Math.round(Math.random()*1e6).toString()};_lp.a.i=function(n){var t=null;n&&n.parentNode&&n.parentNode.parentNode&&n.parentNode.parentNode.parentNode?t=n.parentNode.parentNode.parentNode:_j.e.b(_a.a.f,"Cannot get imageTableCell because of null objects");return t};_lp.a.q=function(n,t){var i=t===2;return n.__type===_gg.O._dataContractName||i&&n.TotalPhotos>1?1:i&&n.TotalPhotos===1&&n.ViewTypePreferred?2:n.__type===_gg.bd._dataContractName||i?3:0};_lp.a.g=function(n,t,i){for(var f=n.split("&"),r=new Sys.StringBuilder,u=0;u<f.length;u++){var e=f[u];switch(e.substring(0,2)){case"w=":r.append("w="+t);break;case"h=":r.append("h="+i);break;default:r.append(e);break}u!==f.length-1&&r.append("&")}return r.toString()};_lp.a.n=function(){var n=document.createElement("div");n.style.display="none";return n};_lp.a.r=function(n,t){var s=null;var e,f,o,u;switch(t.a()){case 1:var r=n;var h=r.FileType?"."+r.FileType:"";e=_ff.g.b(r.Title)+h;f=r.ItemIcon;o=r.Description;u=r.PreviewImageInBase64;s=new _lp.j(e,f,o,u);break;case 2:var i=n;e=i.Title;f=i.ItemIcon;o=i.Description;u=i.Photos&&i.Photos.length>0?i.Photos[0].ImageUrl:null;s=new _lp.j(e,f,o,u);break}return s};_lp.a.m=function(n,t){if(t){var i="";switch(t.a()){case 1:i=t.j("doclink");break;case 2:i=t.j("odcLink");break}n.indexOf(i)<0&&(n+=i)}return n};_lp.a.p=function(){if(!_lp.a.d){if(!window.document)return!1;var n=window.document.createElement("video");_lp.a.d=!!n.canPlayType;if(!_lp.a.d){_lp.b.a().j();_j.e.c(_a.a.f,"IsMotionThumbnailBrowserSupported: The video element is unplayable.")}}return _lp.a.d};_lp.a.prototype={bj:null,bd:null,M:!1,ba:!1,bb:!1,O:null,X:null,w:null,C:null,bM:null,F:null,R:null,be:null,bf:null,d:function(n){this.w=n;return n},bI:function(){return!1},i:function(){for(var i=Object.keys(this.y),t=new Array(i.length),n=0;n<t.length;n++)t[n]=this.y[i[n]];return t},a:function(n){return this.y[n]},u:function(n,t){if(n in this.y){this.y[t]=this.y[n];this.y[t].A=t;delete this.y[n]}},ce:function(n,t){var r=new _g.ez;r.Url=n;var i=this.bz(r);i&&i.e(t);return i},h:function(n,t){var i;var f,u;_lp.g.a(n,f={val:n},u={val:i}),n=f.val,i=u.val;var r=this.ce(t,n);r&&r.L(i);return n},r:function(n){if(!_j.h.a(n)){var t=this.y[n];return!!t&&!!t.c()&&t.b()!=null}return!1},bz:function(n){var t=null;if(!_j.h.a(n.Url))if(n.Url in this.y)t=this.y[n.Url];else{t=new _lp.g(n,this.bf);this.y[n.Url]=t}return t},bg:function(n,t,i,r){var f=!1;i.val=0;r.val=0;var u=window.document.createElement("img");if(_lp.a.c(u,n,t,"TryGetImageDimensions")){f=!0;i.val=u.width;r.val=u.height}return f},bV:function(n){var t=document.createElement("div");t.innerHTML=n;t.style.display="inline-block";var i=document.createElement("div");i.appendChild(t);return i.innerHTML},bF:function(n,t,i){return this.bL(n,t,i)},p:function(n,t){var r=null;var i=0;t.val=!1;var o,f,e;if(e=this.S(n,o={val:r},f={val:i}),r=o.val,i=f.val,e){var u=this.cr(n);u?i===1?this.L(u,r,i):(i===2||i===3)&&(this.w&&r in this.w?this.L(u,r,i):t.val=!0):_j.e.b(_a.a.f,"AddPlayButton: Image anchor was not found")}},e:function(n,t){var i=null;var r=n.querySelectorAll(t);if(r&&r.length>0){i=window.document.createElement("a");i.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";i.style.fontWeight="normal";i.style.position="relative";i.style.styleFloat="right";i.style.cursor="pointer";i.style.padding="8px";i.style.cssText+="float: right";i.style.cssText+=this.R;_j.k.b(i,"mouseenter",this.bp);_j.k.b(i,"mouseleave",this.bq);_j.k.a(i,"-moz-user-select","none");_j.k.a(i,"-khtml-user-select","none");_j.k.a(i,"-webkit-user-select","none");_j.k.a(i,"-ms-user-select","none");var u=r[0];u.appendChild(i);u.parentNode.style.position="relative"}return i},q:function(n){this.cN(n);this.cM(n);var i=n.querySelectorAll("a[id^='LPImageAnchor'] img");if(i&&i.length===1){var r=i[0];_j.e.a(_a.a.f,"Unbinding ImageLoad.  Image src= "+r.src);_j.B.c(i,"load");var t=_lp.a.i(r);if(!t)return;if(t.style.display==="none"){_j.e.a(_a.a.f,"Removing image because Display is set to none.  Image src= "+r.src);t.parentNode.removeChild(t)}else if(!r.src){_j.e.b(_a.a.f,"Removing image because image src is null");t.parentNode.removeChild(t)}}},cN:function(n){var i=n.querySelectorAll("div[id^='LPPlayButtonContainer']");if(i&&i.length===1){var t=i[0];if(_b.l.a(t.parentNode.id,"LPImageAnchor")){var u=t.parentNode;_j.k.c(u,"click");var r=this.bH(n);r?u.href=r.href:_j.e.b(_a.a.f,"RemovePlayButton: Preview anchor was not found")}else _j.e.b(_a.a.f,"RemovePlayButton: Play button parent is not an image anchor");_j.k.e(t)}},m:function(n,t){t.val=null;var i=_lp.c.a(n);i&&(t.val=i.b);return!!t.val},s:function(n){if(!n.href)return!1;var u=-1;var r=n.innerHTML.toLowerCase();var t;var i=_a.P.b(n.href)&&!!(t=new _a.P(n.href)).a&&r.indexOf(t.a.toLowerCase())>u;_j.e.a(_a.a.f,"hrefMatchesLinkText {0} for {1}",i,n.href);return i},b:function(n){switch(n){case 0:return _nbs.a.Gu;case 1:return _nbs.a.Gj;case 2:return _nbs.a.pK;case 5:return _nbs.a.kR;case 6:return _nbs.a.Oa;case 4:return _nbs.a.wz;case 3:return _nbs.a.lR}return""},S:function(n,t,i){t.val=null;i.val=0;if(this.cP(n)){t.val=this.cB(n.id);i.val=this.cA(n.id)}return!!t.val},L:function(n,t,i){var o=n.querySelectorAll("div[id^='LPPlayButtonContainer']");if(o){if(o.length>0){_j.e.a(_a.a.f,"Play button already added. Not adding another");return}}else{_j.e.a(_a.a.f,"Play button was not found");return}i===1?n.href=this.bP(t):(i===2||i===3)&&(n.href=t);this.bR(n,i);var u=this.v(8);var s=this.v(9);u.appendChild(s);n.appendChild(u);this.bQ(n);var f=n.getElementsByTagName("video");if(f&&f.length>0){var e=f[0].paused;Boolean.isInstanceOfType(e)&&!e&&(u.style.display="none")}var r=_j.k.o(n,"div[id^='LPImageContainer']");if(r){_j.B.c(r,"mouseenter");_j.B.f(r,"mouseenter",this.T);_j.B.c(r,"mouseleave");_j.B.f(r,"mouseleave",this.U)}else _j.e.a(_a.a.f,"[LinkPreview: AddPlayButtonElements] imgDivCollection was not found for playbutton url {0}",n.href)},bR:function(n,t){t===1?_j.k.b(n,"click",this.bj):(t===2||t===3)&&_j.k.b(n,"click",this.bd)},bQ:function(n){},bT:function(n){},ch:function(n){if(n.b()){var t=n.b();t.style.cssText+=this.be}},ci:function(n){if(n.b()){var t=n.b();t.style.cssText+=this.R}},bU:function(n,t){t.val=null;var o=0;var u=null;if(_b.l.a(n.id,"LPUrlAnchor"))u=n;else{var l=_b.l.b(n);if(!l)return!1;u=this.bH(l);if(!u)return!1}var i=_lp.c.a(u);if(!i)return!1;var a=null;var e=null;if(i.a){var f=i.a.querySelectorAll("img");if(f&&f.length===1&&f[0]){var v=f[0];a=v.src}}var r=i.b;var h,s,c;(_b.l.a(r.id,"LPBorder_YT")||_b.l.a(r.id,"LPBorder_VT")||_b.l.a(r.id,"LPBorder_BVT"))&&!(c=this.S(r,h={val:e},s={val:o}),e=h.val,o=s.val,c)&&_j.e.b(_a.a.f,"Can't get playerUrl for {0}",n.href);t.val=new _b.bQ(r,i.g,i.e,i.a,a,e,o);return!0},bL:function(n,t,i){var r=this.bz(n);if(r){var u=_lp.a.q(n,r.a());switch(u){case 1:return this.cm(n,r,i);case 2:return this.cn(n,r);case 3:return this.cl(n,r,i);default:return this.co(n,t)}}return null},E:function(n){var t=window.document.createElement("td");n&&(t.id=_lp.a.a(n));return t},A:function(n,t,i,r){if(n){var u=n.querySelector(String.format("td[id^='{0}']",t));if(u){var o=u;o.colSpan=i;if(r){o.style.display="table-cell";if(t==="ImageCell"){var e=u.querySelector("div[id^='LPImageContainer']");var f=u.querySelector("a[id^='LPImageAnchor']");if(e&&f){_j.k.a(e,"width",_j.k.i(f).toString()+"px");_j.k.a(e,"height",_j.k.g(f).toString()+"px")}}}else o.style.display="none"}}},bh:function(n,t){if(t){this.A(n,"TitleCell",3,!0);this.A(n,"ImageCell",1,!0);this.A(n,"TextCell",2,!0);this.A(n,"UrlLinkCell",2,!0);this.A(n,"LPRemovePreviewContainer",1,!0);this.A(n,"LPExpandDescriptionContainer",1,!0);this.A(n,"LPOptionsContainer",1,!0)}else if(!t){this.A(n,"TitleCell",2,!0);this.A(n,"ImageCell",1,!1);this.A(n,"TextCell",2,!0);this.A(n,"UrlLinkCell",1,!0);this.A(n,"LPRemovePreviewContainer",1,!0);this.A(n,"LPExpandDescriptionContainer",1,!0);this.A(n,"LPOptionsContainer",1,!0)}},co:function(n,t){var s=this.F.a().eX().Enabled;var c=n.__type===_gg.bq._dataContractName||this.bN(n);var r=this.v(1);r.setAttribute("cellspacing",0);var o=this.I(r);n.ImageUrl&&this.by(n,n.Url,n.ImageUrl,o,c,!1,!1);var i=this.E("TextCell");i.style.verticalAlign="top";i.style.position="relative";i.style.padding="0px";var l=this.B(21);i.appendChild(l);if(s){var a=this.B(22);i.appendChild(a)}if(n.Title){var e=this.B(5);var v=this.J(n.Url,7,n.Title);e.appendChild(v);i.appendChild(e)}if(n.Url){var h=this.D(20,new _a.P(n.Url).a);i.appendChild(h)}if(n.Description){var f=this.D(6,n.Description);i.appendChild(f);s&&this.cf(n.Url,f,t)}o.appendChild(i);var u=this.P(n,!1);u.appendChild(r);this.bh(u,!1);return u},I:function(n){var t=window.document.createElement("tr");_j.k.a(t,"border-spacing","0px");this.bS(t);n.appendChild(t);return t},cn:function(n,t){var r=n;if(r.Photos.length!==1)return null;var u=t.a()===2;var i=this.P(n,u);if(!this.bx(n,r.Photos,i))return null;u&&(i.className="insertedODCImage");return i},cm:function(n,t,i){var h=n;var c=t.a()===2;if(!h.Photos)return null;var u=this.v(1);u.style.width="90%";var b=this.I(u);var w=this.I(u);var v=this.I(u);if(!this.bx(n,h.Photos,w))return null;var r=this.E(null);r.colSpan=2;var p=this.B(21);r.appendChild(p);if(n.Title)if(c){var y=this.B(23);r.appendChild(y);this.bC(n,r,n.Title,n.ItemIcon)}else{var e=this.B(5);var o=this.J(n.Url,7,n.Title);o.style.verticalAlign="top";var f=this.v(24);f.style.marginTop="-10px";_lp.a.k(f);f.src=_lp.a.h;e.appendChild(f);e.appendChild(o);r.appendChild(e)}if(n.Description){var a=this.D(6,n.Description);r.appendChild(a)}b.appendChild(r);var l=this.E(null);v.appendChild(l);var s=this.P(n,c);s.appendChild(u);return s},cl:function(n,t,i){var e=_lp.a.r(n,t);if(!e)return null;var o=this.v(1);o.setAttribute("cellspacing",0);var s=this.I(o);this.by(n,n.Url,e.c,s,!1,!1,!0);var r=this.E("TextCell");r.style.verticalAlign="top";r.style.position="relative";r.style.padding="0px";var c=this.B(21);r.appendChild(c);var h=this.B(23);r.appendChild(h);this.bC(n,r,e.d,e.b);if(e.a){var l=this.D(6,n.Description);r.appendChild(l)}s.appendChild(r);var f=this.P(n,!1);f.appendChild(o);var u=this.y[n.Url];u.r(n.Id);u&&u.c()&&(u.a()===1?this.t(u,f,i):u.b()!=null&&i&&i(f));this.bh(f,!1);return f},bC:function(n,t,i,r){var s=window.document.createElement("table");t.appendChild(s);var h=this.I(s);var c=this.E(null);h.appendChild(c);if(r){var o=this.v(24);if(_lp.a.c(o,r,n.Url,"LinkPreviewBuilder.AddOneDriveLinkHeadingTable")){var u=this.H(n.Url,7);u.appendChild(o);c.appendChild(u);u.style.marginRight="10px"}}var f=this.E(null);h.appendChild(f);if(n.Title){var e=this.B(5);var a=this.J(n.Url,7,n.Title);e.appendChild(a);f.appendChild(e)}var l=this.B(20);f.appendChild(l)},cf:function(n,t,i){if(!this.bc()&&i){var r={};r.dataType="json";r.url="https://bing-blink.azurewebsites.net/api/blink/summary";r.data=String.format("key={0}&url={1}","c8400ddaf15a43ec",encodeURI(n));r.type="GET";var u=_a.b.b(_a.a.f,"LinkPreviewSummarizationAction",!1,null);var e=this;r.error=function(n,i,r){e.bE(t,i,u)};var f=this;r.success=function(n,r,e){f.cg(t,i,n,r,e,u)};$.ajax(r)}},cg:function(n,t,i,r,u,f){if(i){var c=i;var v="Status";var a="Succeed";var l=c[v];this.bE(n,l,f);if(l===a){var e=this.cz(c);if(!e)return;for(var s=new Sys.StringBuilder,o=0;o<e.length;o++)if(e[o])o<e.length-1?s.append(e[o]+"<br/><br/>"):s.append(e[o]);else continue;var h=s.toString();if(!_j.h.a(h)){n.setAttribute("altdesc",h);t&&t(_b.l.b(n))}}}},bE:function(n,t,i){var r=new _a.l;var u=_b.l.b(n).querySelector("a[id^='LPUrlAnchor']");u?r.b("U",_mco.d.b(u,"href",100)):_j.e.b(_a.a.f,"[LinkPreviewBuilder: LogSuccessFailureCtq] Url was not found");r.b("Status",t);i.m=r.toString();_a.b.a(i)},cz:function(n){for(var c="Data",h="StaticScore",s="Text",t=[],e=n[c],u=e,o=u.length,r=0;r<o;++r){var f=u[r];var l=f[h];if(t.length===3)break;Array.add(t,f)}if(!t.length)return null;for(var i=0;i<t.length;i++)t[i]=t[i][s];return t},bx:function(n,t,i){var s=!1;_j.e.a(_a.a.f,"Adding images for {0}",n.Url);var e=t.length>1;var u;u=this.v(e?12:11);for(var o=t,h=o.length,f=0;f<h;++f){var c=o[f];this.ck(c,n,u,!e,e)&&(s=!0)}var r=this.E(null);r.style.position="relative";r.style.display="table-cell";r.appendChild(u);r.colSpan=2;i.appendChild(r);return s},by:function(n,t,i,r,u,f,e){if(!_j.h.a(i)){var o=this.E("ImageCell");f||(o.style.width="250px");o.style.position="relative";o.style.display="none";o.style.paddingRight=20+"px";o.colSpan=2;r.appendChild(o);_j.e.a(_a.a.f,"Adding image for {0}",t);var h=null;var s;s=f?11:e?26:2;h=this.v(s);var c=this.bD(n,h,t,i,u,f,!1,e);if(!c){_j.e.b(_a.a.f,"Image anchor null for image URL {0}.",i);return}o.appendChild(h)}},ck:function(n,t,i,r,u){var f=null;if(r)if(!n.MimeType||n.MimeType.startsWith("image"))f=n.ImageUrl;else return null;else f=n.MimeType&&n.MimeType==="none"?_lp.a.l:n.ThumbnailUrl;var o=null;if(f){o=this.bD(t,i,n.PhotoPageUrl,f,!1,r,u,!1);if(!n.MimeType||n.MimeType.startsWith("image")){var e=document.createElement("img");e.src=n.ImageUrl;e.id=_lp.a.a("LPFullsizeImageID");var s=_lp.a.n();s.appendChild(e);o.appendChild(s)}}return o},bD:function(n,t,i,r,u,f,e,o){var y;var v;var p,w,a;if(!(a=this.bg(r,i,p={val:y},w={val:v}),y=p.val,v=w.val,a))return null;var h=null;if(u)h=this.cj(n,3);else{var b=e?16:3;h=this.H(i,b)}t.appendChild(h);var s=null;var c;c=f?13:e?14:o?25:4;s=this.v(c);s.id=_lp.a.a("LPThumbnailImageID");h.appendChild(s);var l=_lp.a.g(r,250,140);if(this.Q(n)){_lp.a.c(s,l,i,"LinkPreviewBuilder.CreateImageLink");this.W(n.MotionThumbnailUrl,t,h)}else{_j.k.b(s,"load",this.G);if(!_lp.a.c(s,l,i,"LinkPreviewBuilder.CreateImageLink")){_j.k.c(s,"load");return null}}if(u){_j.k.c(t,"mouseenter");_j.k.b(t,"mouseenter",this.T);_j.k.c(t,"mouseleave");_j.k.b(t,"mouseleave",this.U)}return h},cj:function(n,t){var i=null;if(this.M){i=this.v(t);var u=0;var r=null;if(n.__type===_gg.bq._dataContractName){u=1;r=n.PlayerUrl}else if(n.__type===_gg.bl._dataContractName){r=n.Url;u=2}else if(n.__type===_gg.bc._dataContractName){r=n.Url;u=3}this.L(i,r,u);i.target="_blank"}else i=this.H(n.Url,t);return i},P:function(n,t){var u=window.document.createElement("div");var r=null;var e=0;if(n.__type===_gg.bq._dataContractName){r=n.PlayerUrl;e=1}else if(n.__type===_gg.bl._dataContractName){r=n.Url;e=2}else if(n.__type===_gg.bc._dataContractName){r=n.Url;e=3}var i;i=r?this.cp(r,e):n.__type===_gg.O._dataContractName||t?"LPBorder_PT":"LPBorder_GT";var f=this.y[n.Url];if(f){u.id=f.a()?i+f.p(n.Id):_lp.a.a(i);f.e(u.id)}this.x(u,10);return u},cP:function(n){return this.M&&(_b.l.a(n.id,"LPBorder_YT")||_b.l.a(n.id,"LPBorder_VT")||_b.l.a(n.id,"LPBorder_BVT"))},cD:function(n){return _b.l.a(n.id,"LPBorder_PT")},cB:function(n){var r=n.split("_");var i;var u=0;if(r[0]!=="LPBorder"){_j.e.b(_a.a.f,"BorderId {0} is not video",n);return null}else if(r.length===2||r.length===3){i=r[1];if(i.startsWith("YT"))u=2;else if(i.startsWith("VT"))u=2;else if(i.startsWith("BVT"))u=3;else{_j.e.b(_a.a.f,"BorderId {0} is missing video type",n);return null}}else{_j.e.b(_a.a.f,"BorderId {0} has wrong number of segments",n);return null}var t=i.substr(u);if(t.length>300||t.length<30){_j.e.b(_a.a.f,"Video url {0} is invalid",t);return null}t=this.K(t,"-","+");t=this.K(t,":","/");t=this.K(t,"\\.","=");var f=_a.bh.b(t);if(i.startsWith("YT")&&!f.startsWith("https://www.youtube.com/embed/")){_j.e.b(_a.a.f,"Player url {0} is invalid",f);return null}return this.bP(f)},cp:function(n,t){t===1;var i=_a.bh.a(n);i=this.K(i,"//+","-");i=this.K(i,"/",":");i=this.K(i,"=",".");return t===2?"LPBorder_VT"+i:t===3?"LPBorder_BVT"+i:"LPBorder_YT"+i},cA:function(n){var t=n.split("_");var i;if(t[0]!=="LPBorder"){_j.e.b(_a.a.f,"BorderId {0} is not video",n);return 0}else if(t.length===2||t.length===3){i=t[1];return i.startsWith("VT")?2:i.startsWith("BVT")?3:1}else{_j.e.b(_a.a.f,"BorderId {0} has wrong number of segments",n);return 0}},K:function(n,t,i){var r=new RegExp(t,"g");return n.replace(r,i)},bP:function(n){this.ba||(n=n.replace("autoplay=1","autoplay=0"));return n},bK:function(n){var r=n.b();var i;var t;var s,h,c;if(c=this.bg(r.src,"",s={val:t},h={val:i}),t=s.val,i=h.val,c){if(i<=0||t<=0){_j.e.b(_a.a.f,"Image dimension was invalid for src {0}, height {1}, width {2)",r.src,i,t);return}_j.e.a(_a.a.f,"Loading image for src {0}, height {1}, width {2)",r.src,i,t);var o=!1;var u=!1;if(r.parentNode&&r.parentNode.parentNode){o=_b.l.a(r.parentNode.parentNode.id,"LPBestFitImageContainer");u=_b.l.a(r.parentNode.parentNode.id,"LPImageAlbumContainer")}if(!o&&!u){if(t>i){if(t>250){i=Math.floor(i*250/t);t=250}}else if(i>t){if(i>250){t=Math.floor(t*250/i);i=250}}else if(t>250){t=250;i=250}r.width=t;r.height=i;r.style.width=t.toString()+"px";r.style.height=i.toString()+"px"}var f=_lp.a.i(r);if(f){var e=_b.l.b(f);e&&this.bh(e,!0)}}},bH:function(n){var i=null;var t=n.querySelectorAll("a[id^='LPUrlAnchor']");t&&t.length===1&&(i=t[0]);return i},cr:function(n){var t=this.bG(n);if(!t||!t.length){_j.e.b(_a.a.f,"FindImageAnchor: no image anchors found under ancestor "+n.toString());return null}t.length>1&&_j.e.b(_a.a.f,"FindImageAnchor: more than one anchor found under ancestor "+n.toString()+". Returning the first.");return t[0]},bG:function(n){return n.querySelectorAll("a[id^='LPImageAnchor']")},cq:function(n){return this.Y("div[id^='LPDescription']",n)},ct:function(n){return this.Y("div[id^='LPTitle']",n)},cs:function(n){return this.Y("a[id^='LPImageAnchor'] img",n)},Y:function(n,t){var r=null;var i=t.querySelectorAll(n);i.length===1&&i[0]&&(r=i[0]);return r},B:function(n){return this.D(n,null)},D:function(n,t){var i=this.v(n);t&&(i.textContent=_ff.g.b(t));return i},H:function(n,t){return this.J(n,t,null)},J:function(n,t,i){var r=this.v(t);r.href=n;r.target="_blank";_j.h.b(i)||(r.textContent=_ff.g.b(i));this.bT(r);return r},v:function(n){var t;var i;switch(n){case 1:t="LPContainer";i="table";break;case 2:t="LPImageContainer";i="div";break;case 26:t="LPODImageContainer";i="div";break;case 11:t="LPBestFitImageContainer";i="div";break;case 12:t="LPImageAlbumContainer";i="div";break;case 3:case 16:case 15:t="LPImageAnchor";i="a";break;case 5:t="LPTitle";i="div";break;case 6:t="LPDescription";i="div";break;case 7:t="LPUrlAnchor";i="a";break;case 4:case 25:case 13:case 14:t=null;i="img";break;case 8:t="LPPlayButtonContainer";i="div";break;case 9:t=null;i="span";break;case 17:t=null;i="video";break;case 18:t=null;i="source";break;case 19:t=null;i="button";break;case 20:t="LPMetadata";i="div";break;case 21:t="LPRemovePreviewContainer";i="div";break;case 22:t="LPExpandDescriptionContainer";i="div";break;case 23:t="LPOptionsContainer";i="div";break;case 24:t="LPItemIcon";i="img";break;default:throw Error.notImplemented("Type not implemented for "+n);}var r=window.document.createElement(i);t&&(r.id=_lp.a.a(t));this.x(r,n);return r},z:function(n,t){var i=document.createElement("SPAN");i.style.display="none";document.body.appendChild(i);var e=i;e.setAttribute("class",n);for(var o="",f=t,s=f.length,r=0;r<s;++r){var u=f[r];o+=String.format("{0}: {1};",u,_j.k.h(e,u))}document.body.removeChild(i);return o},x:function(n,t){switch(t){case 10:n.style.marginBottom="20px";n.style.overflow="auto";n.style.display="";n.style.width="100%";n.style.textIndent="0px";break;case 1:n.style.width="90%";n.style.backgroundColor="#FFFFFF";n.style.position="relative";n.style.overflow="auto";n.style.paddingTop="20px";n.style.paddingBottom="20px";n.style.marginTop="20px";n.style.borderTopWidth="1px";n.style.borderTopStyle="dotted";n.style.cssText+=this.z("ms-border-color-neutralTertiaryAlt",["border-top-color"]);n.style.borderBottom=n.style.borderTop;n.setAttribute("role",_j.bn.toString(47));break;case 2:n.style.backgroundColor="#FFFFFF";n.style.height="auto";n.style.position="relative";n.style.margin="auto";n.style.display="table";break;case 12:n.style.marginTop="5px";n.style.backgroundColor="#FFFFFF";n.style.height="auto";n.style.position="relative";break;case 11:n.style.marginTop="2px";n.style.backgroundColor="#FFFFFF";n.style.height="auto";n.style.width="auto";n.style.position="relative";n.style.display="table";break;case 26:n.style.marginTop="2px";n.style.backgroundColor="#FFFFFF";n.style.maxHeight="140px";n.style.position="relative";n.style.overflow="hidden";n.style.marginLeft="auto";n.style.marginRight="auto";n.style.display="inline-block";break;case 3:case 15:n.style.display="table-cell";n.style.textAlign="center";break;case 16:n.style.display="inline-block";n.style.textAlign="center";n.style.width="90px";n.style.height="90px";n.style.verticalAlign="middle";n.style.overflow="hidden";n.style.margin="5px";break;case 14:n.style.display="inline-block";n.style.width="90px";n.style.height="90px";n.style.borderWidth="0px";n.setAttribute("aria-label",_u.n.Lo);break;case 4:case 17:n.style.display="inline-block";n.style.maxWidth="250px";n.style.maxHeight="250px";n.style.height="auto";n.style.width="auto";n.style.borderWidth="0px";n.setAttribute("aria-label",_u.n.Lo);n.style.verticalAlign="bottom";break;case 25:n.style.display="inline-block";n.style.height="auto";n.style.width="100%";n.style.borderWidth="0px";n.style.marginLeft="20px";n.setAttribute("aria-label",_u.n.Lo);n.style.verticalAlign="bottom";break;case 13:n.style.display="inline-block";n.style.marginLeft="auto";n.style.marginRight="auto";n.style.height="auto";n.style.width="auto";n.style.maxWidth="100%";n.style.borderWidth="0px";n.setAttribute("aria-label",_u.n.Lo);break;case 5:n.style.top="0px";n.style.cssText+=this.z("ms-font-xl ms-font-weight-light ms-font-color-themePrimary",["color","font-weight","font-size","font-family"]);n.style.lineHeight=n.style.fontSize;break;case 6:n.style.display="block";n.style.cssText+=this.z("ms-font-m ms-font-color-neutralSecondary",["color","font-weight","font-family"]);n.style.fontSize=14+"px";n.style.lineHeight=20+"px";n.style.maxHeight=100+"px";n.style.overflow="hidden";break;case 7:n.style.textDecoration="none";break;case 8:n.style.top="50%";n.style.marginTop="-20px";n.style.position="absolute";n.style.left="0px";n.style.right="0px";n.style.marginLeft="auto";n.style.marginRight="auto";break;case 9:n.className=_lp.d.a().b;n.style.color="#FFFFFF";break;case 24:case 18:break;case 19:n.style.position="absolute";n.style.right="0px";n.style.bottom="0px";n.style.width="30px";n.style.height="30px";n.style.border="0";n.style.cursor="pointer";n.style.backgroundColor="rgba(0, 0, 0, 0.56)";n.style.cssText+=this.z("ms-font-color-neutralLight",["color"]);break;case 20:n.style.margin="10px 0px 16px 0px";n.style.cssText+=this.z("ms-font-m ms-font-color-neutralSecondary",["color","font-weight","font-family"]);n.style.fontSize=14+"px";n.style.lineHeight=n.style.fontSize;break;case 21:case 22:case 23:n.style.styleFloat="right";break;default:throw Error.notImplemented("Style settings not implemented for "+t);}},bS:function(n){n&&n.setAttribute("valign","top")},f:function(n,t,i,r,u,f,e){_j.e.a(_a.a.f,"Adding link preview for {0}",n.Url);this.l(t);if(this.bN(n)&&this.w){var l=this.Z(n,!0);l=this.bV(l);var y=new _lp.i(l);this.Q(n)&&(y.b=n.MotionThumbnailUrl);this.w[n.Url]=y}if(n.__type===_gg.O._dataContractName&&this.w){var h=n;if(h.Photos)for(var c=0;c<h.Photos.length;c++){var w=h.Photos[c];this.w[w.PhotoPageUrl]=new _lp.h(h.Photos,c)}if(this.cL(i,n.Id))return}if(_b.l.k(n))this.cQ(n,i);else{var a=i.querySelector("#"+n.Id);if(!a||!_j.k.C(a,"a")){_j.e.b(_a.a.f,"Anchor for preview {0} not found",n.Url);return}var o=this.bF(n,u,f);if(!o)return;var s=a;var v=this.y[n.Url];if(v){s.id=_lp.a.m(s.id,v);this.cu(s,n,v)}r&&(o=r(o));var p=!r;this.cC(s,o,p)}e&&e.a(_a.cD,new _a.cD("LP"))},cu:function(n,t,i){if(i.a()&&n.href!==t.Url){n.innerText!==n.href||this.bI()||(n.innerText=t.Url);n.href=t.Url}},cL:function(n,t){var r=n.querySelector("#"+t.replace(".","\\."));if(!r||!_j.k.C(r,"a"))return!1;var u=r;var i=_lp.c.a(u);if(!i)return!1;i.d&&i.d.parentNode.removeChild(i.d);return!0},l:function(n){if(this.C&&this.C.d.length>0){var t=this.cv(this.C);t&&n(t)}},o:function(n){var t=this.cF(n);this.bA(t)},bA:function(n){this.C||(this.C=new _j.q);for(var t=0;t<this.C.d.length;t++)if(this.C.d[t].Url===n.Url)return;if(!this.C.g(n)){_j.e.a(_a.a.f,"Adding GetLinkPreview request for "+n.Url+" to request queue.");this.C.c(n)}},cF:function(n){var t=null;t=new _g.cH;t.Id="UpdateOEmbed__"+n.id;t.Url=n.href;return t},cE:function(n){var t=null;t=new _g.cH;t.Id=n.id;t.Url=n.href;return t},cv:function(n){if(!n||!n.d.length)return null;var t=n.d[0];n.j(0);t.RequestStartTimeMilliseconds=_a.d.a().h();return t},cQ:function(n,t){var e=n.Id.split("__")[1];var i=this.Z(n,!0);if(i){if(this.w){i=this.bV(i);var c=new _lp.i(i);this.Q(n)&&(c.b=n.MotionThumbnailUrl);this.w[n.Url]=c}e=e.replace(".","\\.");var l=t.querySelector("#"+e);var h=l;if(h){var r=_lp.c.a(h);if(!r)return;var s=!1;var o;this.p(r.b,o={val:s}),s=o.val;if(r.a){var u=r.a;u.style.position="relative";if(this.Q(n)){var f=u.querySelector("a[id^='LPImageAnchor']");if(f){f.style.textDecoration="none";this.W(n.MotionThumbnailUrl,u,f)}}}}}},cC:function(n,t,i){_j.e.a(_a.a.f,"Inserting link preview for {0}",n.href);var f=this.cO(n);if(f){_j.e.a(_a.a.f,"Inserting before new line element {0}",f);n.parentNode.insertBefore(t,f)}else{var r=n.parentNode;if(!r.parentNode){_j.e.b(_a.a.f,"Could not insert link preview because of undefined parent node of link parent node {0}",r);return}if(r.nextSibling){_j.e.a(_a.a.f,"Inserting before link parent node next sibling {0}",r.nextSibling);r.parentNode.insertBefore(t,r.nextSibling)}else{_j.e.a(_a.a.f,"Appending to child to link parent node {0}",r);r.parentNode.appendChild(t)}}if(i){var u=t.nextSibling;if(u&&u.tagName&&u.tagName.toLowerCase()==="br"){_j.e.a(_a.a.f,"Removing preview next sibling which is a br tag");t.parentNode.removeChild(u)}}else if(!_a.n.a().J){var e=document.createElement("br");t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)}},cO:function(n){for(var i=null,t=n.nextSibling;t;){if(t.tagName)switch(t.tagName.toLowerCase()){case"div":case"br":case"p":i=t;break}t=i?null:t.nextSibling}return i},bc:function(){return!1},g:function(n){if(n in this.w){var t=this.w[n];if(t.a===1)return t.c}return null},k:function(n){if(n in this.w){var t=this.w[n];if(t.a===2)return!0}return!1},j:function(n,t,i){t.val=null;i.val=-1;var r=this.w[n];if(r.a===2){t.val=r.c;i.val=r.b;return!0}return!1},bN:function(n){return this.Z(n,!1)?!0:!1},Z:function(n,t){var i=null;n.__type===_gg.bc._dataContractName?i=n.EmbeddedHtml:n.__type===_gg.bl._dataContractName&&(i=n.EmbeddedHtml);if(t&&i){var u=document.createElement("div");u.innerHTML=i;var r=u.querySelectorAll("iframe");if(r&&r.length>0){r[0].setAttribute("width",600+"px");r[0].setAttribute("height",420+"px")}i=u.innerHTML}return i},t:function(n,t,i){_j.e.a(_a.a.f,"SubmitGetSharingInfoAction");if(this.O&&this.bb&&n&&n.c()&&!_j.h.a(n.c().a())){var r=_a.b.b(_a.a.f,"GetSharingInfo",!1,null);var e=new _db.V(n.c().a());var o=this,u=this,f=this;this.O.a(e,function(u){o.cy(u,n,t,i,r)},function(n){u.cx(n,r)},function(n){f.cw(n,r)})}},cy:function(n,t,i,r,u){_j.e.a(_a.a.f,"GetSharingInfoSucceeded");if(_db.V.isInstanceOfType(n)){var o=n;var e=o.f;if(e){var f=t.c();f.u(e.CanShareInternally);f.s(e.CanCreateOrganizationEditLink);f.t(e.CanCreateOrganizationViewLink);f.e(e.CanCreateAnonymousEditLink);f.f(e.CanCreateAnonymousViewLink);if(f.b()){switch(t.n()){case 3:t.d(f.h()?6:0);break;case 2:t.d(f.i()?5:0);break;case 5:t.d(f.c()?4:0);break;case 4:t.d(f.d()?3:0);break;default:t.d(0);break}e.IsOrganizationEditLinkAvailable&&f.l(e.OrganizationEditLink);e.IsOrganizationViewLinkAvailable&&f.m(e.OrganizationViewLink);f.g(o.e.attachmentUrl)}else{u.n="UnableToShare";t.d(0)}t.t(f);r&&r(_b.l.b(i));var h=t.b()?t.b():0;var s=new _db.cE(t.f(),t.k(),h,e.CanShareExternally,e.CanShareInternally);this.X.a(_db.W,new _db.W(s))}}},cx:function(n,t){t.n="GetSharingInfoFailed";t.p=n.O();_j.e.a(_a.a.f,"GetSharingInfoFailed")},cw:function(n,t){_a.b.a(t)},c:function(n,t,i,r,u){},Q:function(n){return this.M&&_lp.a.p()&&n.__type===_gg.bc._dataContractName&&!_j.h.a(n.MotionThumbnailUrl)},W:function(n,t,i){var r=i.querySelector("video");if(r)this.x(r,17);else{r=this.v(17);i.appendChild(r)}_j.k.x(r);var u=r.querySelector("source");if(u)this.x(r,18);else{u=this.v(18);u.setAttribute("Src",n);r.appendChild(u)}_j.k.b(u,"error",this.bs);_j.k.b(r,"loadedmetadata",this.bw);r.muted=!1;this.bB(t,r);t.style.display=""},n:function(n){var t=n.querySelector("div[id^='LPImageContainer']");if(t){var i=n.querySelector("a[id^='LPImageAnchor'] video");this.V([t,i])&&this.bB(t,i)}else _j.e.a(_a.a.f,"[LinkPreviewBuilderMotionThumbnail: AddMotionThumbnailElementsToBorder] border element was not found")},cM:function(n){var i=n.querySelector("div[id^='LPImageContainer']");if(i){var t=i.querySelector("button");if(t){_j.k.c(t,"click");_j.k.c(t,"mouseenter");_j.k.c(t,"mouseleave");_j.k.e(t)}}else _j.e.a(_a.a.f,"[LinkPreviewBuilderMotionThumbnail: RemoveMotionThumbnailElements] preview element was not found")},cT:function(n){var i=n.i();if(i.tagName.toLowerCase()==="video"){var e=i.videoWidth;var o=i.videoHeight;_j.e.a(_a.a.f,"VideoMetadataLoad video original dimensions: "+e+","+o);if(Number.isInstanceOfType(e)&&Number.isInstanceOfType(o)){var t=i.parentNode.querySelector("img");if(!t){_lp.b.a().i(i);return}var s=t.src;var h=e;var l=o;var r=250;var u=Math.round(l*r/h);if(t.width!==r||t.height!==u){var c=_lp.a.g(s,r,u);_j.k.b(t,"load",this.G);_lp.a.c(t,c,s,"LinkPreviewBuilder.VideoMetadataLoad")||_j.k.c(t,"load")}i.style.width=String.format("{0}{1}",r,"px");i.style.height=String.format("{0}{1}",u,"px");t.style.width=String.format("{0}{1}",r,"px");t.style.height=String.format("{0}{1}",u,"px");var f=_j.k.o(t,"div[id^='LPImageContainer']")[0];f&&r>_j.k.i(f)&&(f.style.width=_j.h.c("{0}{1}",r,"px"));_j.k.b(i,"click",this.br)}}},bi:function(n,t){n?n.muted=_lp.a.b:_j.e.a(_a.a.f,"[LinkPreviewBuilderMotionThumbnail: UpdateMuteButtonDisplay] video element was not found");if(t)if(_lp.a.b){_j.k.f(t,_lp.a.f);_j.k.d(t,_lp.a.e)}else{_j.k.f(t,_lp.a.e);_j.k.d(t,_lp.a.f)}else _j.e.a(_a.a.f,"[LinkPreviewBuilderMotionThumbnail: UpdateMuteButtonDisplay] muteButton was not found")},cR:function(n){if(n.b()){_j.e.a(_a.a.f,"VideoContainerMouseEnterHandler target: "+n.b());var f=n.b();var l=f.id.startsWith("LPImageContainer")?f:_j.k.o(f,"div[id^='LPImageContainer']")[0];var t;var i;var u;var r;var h,c,o,s;this.bJ(l,h={val:t},c={val:i},o={val:u},s={val:r}),t=h.val,i=c.val,u=o.val,r=s.val;if(!t&&i){_j.k.f(i,_lp.d.a().b);_j.k.d(i,_lp.d.b().b)}else if(this.V([t,u,i,r])){var e=t.networkState;if(Number.isInstanceOfType(e)&&e!==1){_lp.b.a().l(t,e);_j.e.b(_a.a.f,"VideoContainerMouseEnterHandler: The network state is invalid.")}else{this.bi(t,r);_j.k.x(u);_j.k.v(t);t.currentTime=0;_j.k.D(t,"play");_j.k.v(r);_j.k.x(i)}}else _j.e.b(_a.a.f,"VideoContainerMouseEnterHandler: Did not know how to process target "+n.b())}},cS:function(n){this.bO(n,!0)},cG:function(n){_lp.b.a().e=!0;this.bO(n,!1)},cH:function(n){var t=_j.k.o(n.b(),"video");t&&t.length>0&&_lp.b.a().k(t[0]);_j.e.c(_a.a.f,"MotionThumbnailErrorHandler: An error occurred.")},cI:function(n){if(n.b()&&n.b().tagName.toLowerCase()==="button"){var i=n.b();var t=i.parentNode.querySelector("video");if(t){_lp.a.b=!_lp.a.b;this.bi(t,i);_lp.b.a().m()}else _j.e.a(_a.a.f,"[LinkPreviewBuilderMotionThumbnail: MuteButtonClickHandler] video element was not found")}},cJ:function(n){if(n.b()&&n.b().tagName.toLowerCase()==="button"){var t=n.b();t.style.backgroundColor="rgba(0, 0, 0, 0.9)";t.style.cssText+=this.z("ms-font-color-white",["color"])}},cK:function(n){if(n.b()&&n.b().tagName.toLowerCase()==="button"){var t=n.b();t.style.backgroundColor="rgba(0, 0, 0, 0.56)";t.style.cssText+=this.z("ms-font-color-neutralLight",["color"])}},bB:function(n,t){var i=n.querySelector("button");if(i)this.x(i,19);else{i=this.v(19);n.appendChild(i)}_j.k.c(i,"click");_j.k.b(i,"click",this.bt);_j.k.b(i,"mouseenter",this.bu);_j.k.b(i,"mouseleave",this.bv);this.bi(t,i);var r=t.paused;Boolean.isInstanceOfType(r)&&r&&_j.k.x(i)},bO:function(n,t){if(n.b()){_j.e.a(_a.a.f,"PauseVideo target: "+n.b());var e=n.b();var l=e.id.startsWith("LPImageContainer")?e:_j.k.o(e,"div[id^='LPImageContainer']")[0];var i;var r;var u;var f;var c,o,s,h;this.bJ(l,c={val:i},o={val:r},s={val:u},h={val:f}),i=c.val,r=o.val,u=s.val,f=h.val;if(!i&&r){_j.k.f(r,_lp.d.b().b);_j.k.d(r,_lp.d.a().b)}else if(this.V([i,u,r,f])){_j.k.D(i,"pause");_j.k.x(f);_j.k.v(r);_j.k.x(i);_j.k.v(u);t&&_lp.b.a().h(i,this.bc());i.currentTime=0}else _j.e.b(_a.a.f,"PauseVideo: Did not know how to process target "+n.b())}},bJ:function(n,t,i,r,u){t.val=n.querySelector("a[id^='LPImageAnchor'] video");i.val=n.querySelector("div[id^='LPPlayButtonContainer'] span");r.val=n.querySelector("a[id^='LPImageAnchor'] img");u.val=n.querySelector("button")},V:function(n){for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];if(!r)return!1}return!0}};_lp.f=function(n){this.c=n&&n.a?n.a.bH.SPO_RootSiteUrl:""};_lp.f.prototype={c:null,b:function(n,t,i,r,u,f,e){return new _lp.a(n,t,i,r,u,f,e,this.c)},a:function(n,t,i,r,u,f,e){var o=null;switch(u.a()){case"TouchNarrow":o=new _lp.m(n,t,i,r,u,f,e,this.c);break;default:o=new _lp.e(n,t,i,r,u,f,e,this.c);break}return o}};function LinkPreviewComponent(){}LinkPreviewComponent.$$cctor=function(){_a.t.a().a(LinkPreviewComponent)};LinkPreviewComponent.prototype={b:function(n,t,i){var r=this;n.b(_lp.f,function(){return new _lp.f(n.a(_y.H))}).b(_b.I).a()},a:function(){return null}};_lp.g=function(n,t){this.J=[];this.A=n.Url;this.H=n.Title;this.G=n.Id;if(n.__type===_gg.bd._dataContractName){this.N(n);var i=!_j.h.a(t)&&!_j.h.a(this.A)&&this.A.startsWith(t);this.K(i?2:1)}else if(n.__type===_gg.iT._dataContractName){this.O(n);this.K(1)}else this.w=0};_lp.g.a=function(n,t,i){t.val=n;i.val="";var r;var u;if((r=t.val.indexOf("["))>-1&&(u=t.val.indexOf("]"))>r){i.val=t.val.substring(r+1,u);t.val=t.val.substring(0,r)+t.val.substring(u+1,t.val.length)}};_lp.g.prototype={C:null,B:0,F:null,x:null,b:function(){return this.x},d:function(n){this.x=n;return n},D:!1,m:function(){return this.D},s:function(n){this.D=n;return n},w:0,a:function(){return this.w},z:null,h:function(){return this.z},I:null,l:function(){return this.I},G:null,f:function(){return this.G},r:function(n){this.G=n;return n},H:null,k:function(){return this.H},c:function(){this.F||(this.F=new _lp.n);return this.F},t:function(n){this.F=n;return n},E:0,n:function(){return this.E},g:function(){return this.C},A:null,o:function(){return this.A},e:function(n){Array.add(this.J,n)},u:function(n,t){if(this.w){var i=this;Array.forEach(this.J,function(i){var f=i;var r=n.querySelector(String.format("[id^='{0}']",f));if(r){var u=r.querySelector(String.format("[id^='{0}']","LPMetadata"));u&&(u.innerText=t)}})}},v:function(n){_j.h.a(this.C)||this.u(n,String.format(_nbs.a.OZ,this.C))},q:function(){var n=new Sys.StringBuilder;if(this.w){switch(this.w){case 1:n.append(this.y(2,"doclink"));break;case 2:n.append(this.y(2,"odcLink"));break}this.z!=null&&n.append(this.y(3,(this.z==null?0:this.z).toString()));this.x!=null&&n.append(this.y(4,(this.x==null?0:this.x).toString()));this.D&&n.append(this.y(5,"1"));if(!_j.h.a(this.c().a())){var t=this.c().a();if(t.startsWith("https://")){t=t.slice(8);n.append(this.y(6,t))}}this.B&&n.append(this.y(7,""+this.B))}return n.isEmpty()?"":"["+n+"]"},L:function(n){for(var o=n.split("|"),u=o,s=u.length,r=0;r<s;++r){var e=u[r];var i=e.split(":");if(i.length===2){var f=i[0];var t=i[1];switch(Number.parseInvariant(f)){case 1:break;case 2:this.P(t);break;case 3:this.z=Number.parseInvariant(t);break;case 4:this.x=Number.parseInvariant(t);break;case 5:this.D=!!Number.parseInvariant(t);break;case 6:this.c().g("https://"+t);break;case 7:this.K(Number.parseInvariant(t));break}}}},i:function(n){return this.M(n,1)},p:function(n){return this.y(1,n)},j:function(n){return this.y(2,n)},y:function(n,t){return"|"+n+":"+t},M:function(n,t){for(var o=n.split("|"),u=o,f=u.length,i=0;i<f;++i){var e=u[i];var r=e.split(":");if(r.length===2&&r[0]===t.toString())return r[1]}return""},N:function(n){var t=n;switch(t.DataProviderType){case 32:this.z=0;break}this.E=t.LinkType;this.c().g(t.LinkingUrl);this.w=1},O:function(n){var t=n;this.E=t.LinkType;this.I=t.FileId;this.w=2;switch(this.E){case 5:this.c().e(!0);this.c().f(t.HasPermissions);this.c().j(t.Url);this.x=4;break;case 4:this.c().e(t.HasPermissions);this.c().f(!0);this.c().k(t.Url);this.c().v(t.ViewTypePreferred);this.x=3;break}},P:function(n){switch(n){case"doclink":this.w=1;break;case"odcLink":this.w=2;break;default:this.w=0;break}},K:function(n){this.B=n;this.B===2?this.C=_nbs.a.HM:this.B===1&&(this.C=_nbs.a.du)}};_lp.l=function(n){this.b=n};_lp.l.prototype={b:null,g:null,e:null,c:null,a:null,f:null,d:null};_lp.o=function(n){this.a=n};_lp.o.prototype={a:0};_lp.k=function(){_lp.k.initializeBase(this,[3])};_lp.h=function(n,t){_lp.h.initializeBase(this,[2]);this.c=n;this.b=t};_lp.h.prototype={c:null,b:0};_lp.i=function(n){_lp.i.initializeBase(this,[1]);this.c=n;this.b=null};_lp.i.prototype={c:null,b:null};_lp.b=function(){this.f=0;this.g=0;this.e=!1;this.a=new _a.l;this.b=_a.b.b(_a.a.f,"LinkPreviewMotionThumbnail",!1,null)};_lp.b.a=function(){_lp.b.b||(_lp.b.b=new _lp.b);return _lp.b.b};_lp.b.prototype={b:null,a:null,f:0,g:0,e:!1,m:function(){_lp.a.b?this.f+=1:this.g+=1},h:function(n,t){var r;var i;var f,u;this.d(n,f={val:r},u={val:i}),r=f.val,i=u.val;var s=t?"R":"C";var o=_lp.a.b?"M":"UM";var e=this.e?"Y":"N";this.a.b("P",s);this.a.b("U",r);this.a.b("S",i);this.a.a("M",this.f);this.a.a("UM",this.g);this.a.b("FS",o);this.a.b("C",e);this.a.b("TS",n.currentTime.toString());this.a.b("TT",n.duration.toString());this.c()},i:function(n){var i;var t;var u,r;this.d(n,u={val:i},r={val:t}),i=u.val,t=r.val;this.a.b("U",i);this.a.b("S",t);this.b.n="ImageLoadError";this.b.p="The image failed to load, so the video was not loaded";this.c()},k:function(n){var i;var t;var u,r;this.d(n,u={val:i},r={val:t}),i=u.val,t=r.val;this.a.b("U",i);this.a.b("S",t);this.b.n="VideoLoadError";this.b.p="The video failed to load";this.c()},j:function(){this.b.n="VideoElementUnplayableError";this.b.p="Cannot play the video DOM element";this.c()},l:function(n,t){var u;var r;var f,e;this.d(n,f={val:u},e={val:r}),u=f.val,r=e.val;var i;switch(t){case 0:i="The element has not yet been initialized";break;case 1:i="The element's resource selection algorithm is active and has selected a resource, but it is not actually using the network at this time";break;case 2:i="The user agent is actively trying to download data";break;case 3:i="The element's resource selection algorithm is active, but it has not yet found a resource to use";break;default:i="The video cannot be played due to a network error";break}this.a.b("U",u);this.a.b("S",r);this.b.n="VideoNetworkError";this.b.p=i;this.c()},c:function(){this.b.m=this.a.toString();_a.b.a(this.b);_lp.b.b=null},d:function(n,t,i){var u=n.querySelector("source");var r=_j.k.o(n,"a[id^='LPImageAnchor']");t.val=_mco.d.b(r.length>0?r[0]:null,"href",100);i.val=_mco.d.b(u,"src",100)}};_lp.m=function(n,t,i,r,u,f,e,o){_lp.m.initializeBase(this,[n,t,i,r,u,f,e,o])};_lp.m.prototype={bU:function(n,t){t.val=null;var f=null;var e=null;var c=null;var r=null;var u=0;var i=null;i=_b.l.b(n);if(!i)return!1;f=this.ct(i);if(!f)return!1;e=this.cq(i);if(!e)return!1;var l=this.cs(i);l&&(c=l.src);var h,o,s;!_b.l.a(i.id,"LPBorder_YT")&&!_b.l.a(i.id,"LPBorder_VT")||(s=this.S(i,h={val:r},o={val:u}),r=h.val,u=o.val,s)||_j.e.b(_a.a.f,"Can't get playerUrl for {0}",n.href);t.val=new _b.bQ(i,f,e,null,c,r,u);return!0},bL:function(n,t,i){return n.__type===_gg.O._dataContractName?this.cW(n):this.cX(n)},cX:function(n){var t=this.v(10);(n.ImageUrl||n.__type===_gg.bd._dataContractName&&n.PreviewImageInBase64)&&this.cU(n,t);if(n.Title){var i=this.B(5);var f=this.J(n.Url,7,n.Title);i.appendChild(f);t.appendChild(i)}if(n.Url){var e=new _a.P(n.Url);var r=this.D(20,e.a);t.appendChild(r)}if(n.Description){var u=this.D(6,n.Description);t.appendChild(u)}return t},cW:function(n){var t=this.v(10);var r=n;if(n.Title){var i=this.B(5);var f=this.J(n.Url,7,n.Title);i.appendChild(f);t.appendChild(i)}if(n.Description){var u=this.D(6,n.Description);t.appendChild(u)}r.Photos&&this.cV(n,r.Photos,t);return t},cU:function(n,t){_j.e.a(_a.a.f,"Adding image for {0}",n.Url);var i=this.v(4);_j.k.b(i,"load",this.G);var f=n.__type===_gg.bd._dataContractName&&n.PreviewImageInBase64?n.PreviewImageInBase64:n.ImageUrl;if(!_lp.a.c(i,f,n.Url,"NarrowReadingPanePreviewBuilder.AddImage")){_j.k.c(i,"load");return}var u=this.H(n.Url,3);u.appendChild(i);var r=this.v(2);r.appendChild(u);r.style.display="none";t.appendChild(r)},cV:function(n,t,i){_j.e.a(_a.a.f,"Adding images for {0}",n.Url);var e=this.v(t.length===1?11:12);e.style.display="none";for(var o=t,h=o.length,f=0;f<h;++f){var s=o[f];var r=null;var u=null;if(t.length===1){r=this.v(13);_j.k.b(r,"load",this.G);r.src=s.ImageUrl;u=this.H(n.Url,15)}else{r=this.v(14);_j.k.b(r,"load",this.G);r.src=s.ThumbnailUrl;u=this.H(n.Url,16)}u.appendChild(r);e.appendChild(u)}i.appendChild(e)},bK:function(n){var t=n.b();var r;var i;var o,f,e;if(e=this.bg(t.src,"",o={val:i},f={val:r}),i=o.val,r=f.val,e){if(r<=0||i<=0){_j.e.b(_a.a.f,"Image dimension was invalid for src {0}, height {1}, width {2)",t.src,r,i);return}_j.e.a(_a.a.f,"Loading image for src {0}, height {1}, width {2)",t.src,r,i);var u=t.parentNode.parentNode;u.style.display="block";_b.l.a(u.id,"LPImageAlbumContainer")||(u.style.width=_j.k.h(t,"width"));u.style.height=_j.k.h(t,"height")}},v:function(n){var t;var i;switch(n){case 10:t="LPBorder";i="div";break;case 2:t="LPImageContainer";i="div";break;case 11:t="LPBestFitImageContainer";i="div";break;case 12:t="LPImageAlbumContainer";i="div";break;case 3:case 16:case 15:t="LPImageAnchor";i="a";break;case 4:case 13:case 14:t=null;i="img";break;case 5:t="LPTitle";i="div";break;case 6:t="LPDescription";i="div";break;case 7:t="LPUrlAnchor";i="a";break;case 17:t=null;i="video";break;case 18:t=null;i="source";break;case 19:t=null;i="button";break;case 20:t="LPMetadata";i="div";break;default:throw Error.notImplemented("Type not implemented for "+n);}var r=window.document.createElement(i);t&&(r.id=_lp.a.a(t));this.cY(r,n);return r},cY:function(n,t){switch(t){case 10:n.style.borderTopColor="#CCCCCC";n.style.borderTopWidth="1px";n.style.borderTopStyle="dotted";n.style.borderBottom=n.style.borderTop;n.style.width="95%";n.style.marginTop="20px";n.style.marginBottom="20px";n.style.backgroundColor="#FFFFFF";n.style.padding="20px 0 20px 0";break;case 2:n.style.backgroundColor="#FFFFFF";n.style.maxWidth="95%";n.style.width="250px";n.style.height="140px";n.style.position="relative";n.style.display="block";n.style.margin="auto";break;case 11:n.style.backgroundColor="#FFFFFF";n.style.position="relative";n.style.marginTop="20px";break;case 12:n.style.backgroundColor="#FFFFFF";n.style.position="relative";n.style.marginTop="20px";n.style.width="auto";n.style.overflow="hidden";break;case 3:case 15:break;case 16:n.style.display="table-cell";break;case 4:case 17:n.style.display="block";n.style.margin="auto";n.style.maxWidth="250px";n.style.maxHeight="140px";break;case 14:n.style.maxHeight="140px";n.style.borderWidth="0px";break;case 13:n.style.display="block";n.style.marginRight="auto";n.style.marginLeft="auto";n.style.maxWidth="250px";n.style.height="auto";n.style.borderWidth="0px";break;case 5:n.style.marginTop="10px";n.style.cssText+=this.z("ms-font-xl ms-font-weight-light ms-font-color-themePrimary",["color","font-weight","font-size","font-family"]);n.style.lineHeight=n.style.fontSize;break;case 7:n.style.textDecoration="none";break;default:this.x(n,t);break}}};_lp.j=function(n,t,i,r){this.d=n;this.b=t;this.a=i;this.c=r};_lp.j.prototype={d:null,b:null,a:null,c:null};_lp.e=function(n,t,i,r,u,f,e,o){this.bW=Function.createDelegate(this,this.dm);this.bX=Function.createDelegate(this,this.dn);this.bZ=Function.createDelegate(this,this.dq);this.bY=Function.createDelegate(this,this.dp);this.cc=new _j.q;_lp.e.initializeBase(this,[null,null,r,u,f,null,e,o]);this.bn=n;this.bo=t;this.bl=i};_lp.e.b=function(n){var t;t=_b.l.a(n.id,"LPBestFitImageContainer")?11:_b.l.a(n.id,"LPODImageContainer")?26:_b.l.a(n.id,"LPImageAlbumContainer")?12:2;return t};_lp.e.prototype={bn:null,bo:null,bl:null,bI:function(){return!0},ds:function(n){n.setAttribute("PreviewInformation",1)},dg:function(n,t,i){t.val=!1;i.val=!1;var ft=0;var o=n.b;var u=n.c;if(n.a){var f=n.a;var a=this.bG(f);if(!a){_j.e.a(_a.a.f,"Image anchors not found for {0}",u.href);return!1}for(var y=null,nt=0,w=0,ut=a.length;w<ut;w++){var r=a[w];if(!r){_j.e.a(_a.a.f,"Image anchor not found for {0}",u.href);return!1}var c=r.getElementsByTagName("img");var l=r.getElementsByTagName("span");if(c.length===2&&this.cD(o)){y||(y=new Array(a.length));var tt;this.cZ(r,y,tt={val:nt}),nt=tt.val}else if(c.length!==1){_j.e.a(_a.a.f,"Unexpected img count {0} for {1}",c.length,u.href);return!1}var v=_lp.e.b(f);if(l.length!==1)_j.e.a(_a.a.f,"Unexpected span count {0} for {1}",l.length,u.href);else{l[0].style.height="auto";l[0].style.width=v===11||v===12?"auto":"140px"}var h=c[0];switch(v){case 11:this.x(h,13);this.x(r,15);this.x(f,12);break;case 12:this.x(h,14);this.x(r,16);this.x(f,12);ft++;break;case 26:this.x(h,25);this.x(r,3);this.x(f,26);break;default:this.x(h,4);this.x(r,3);this.x(f,2);break}var it=!1;var s=null;var e=0;var k,b,g;if(g=this.S(o,k={val:s},b={val:e}),s=k.val,e=b.val,g)if(e===1)this.L(r,s,e);else if(e===2||e===3)if(this.w&&s in this.w){var d=this.w[s].b;if(d){var p=f.querySelectorAll("a[id^='LPImageAnchor']");p&&p.length>0&&this.W(d,f,p[0])}this.L(r,s,e);it=!0}else t.val=!0;if(!it){r.setAttribute("PreviewInformation",2);this.N(r)}}}this.dd(n.e);this.bS(n.f);this.bm(o,"[id^='LPRemovePreviewContainer']");this.bm(o,"[id^='LPExpandDescriptionContainer']");this.bm(o,"[id^='LPOptionsContainer']");u.setAttribute("PreviewInformation",2);this.N(u);if(this.F.a()&&this.F.a().gw().Enabled){this.h(o.id,u.href);if(!(u.href in this.w)){var rt=this.y[u.href];rt&&rt.a()&&(this.w[u.href]=new _lp.k)}}_j.e.a(_a.a.f,"Finished fixing link preview markup for {0}",u.href);return!0},bm:function(n,t){var i=n.querySelectorAll(t);i&&_j.B.d(i)},cZ:function(n,t,i){var r=new _g.cK;var f=n.querySelector(String.format("[id^='{0}']","LPThumbnailImageID"));f&&(r.ThumbnailUrl=f.src);var u=n.querySelector(String.format("[id^='{0}']","LPFullsizeImageID"));u&&(r.ImageUrl=u.src);r.PhotoPageUrl=n.href;if(r.ThumbnailUrl&&r.ImageUrl){t[i.val]=r;this.w[r.PhotoPageUrl]=new _lp.h(t,i.val);i.val++}},de:function(n){var r;var t;n=this.bk(n);var f,u;if(!(u=_lp.a.prototype.bU.call(this,n,f={val:t}),t=f.val,u))return null;var i;if(t.a===1&&t.f){_j.e.a(_a.a.f,"Constructing YouTubeLinkPreview object for {0}",n.href);i=new _gg.bq;i.PlayerUrl=t.f}else if(t.a===2){_j.e.a(_a.a.f,"Constructing OEmbedVideoPreview object for {0}",n.href);i=new _gg.bl;i.EmbeddedHtml=null}else if(t.a===3){_j.e.a(_a.a.f,"Constructing BingVideoLinkPreview object for {0}",n.href);i=new _gg.bc;i.EmbeddedHtml=null}else if(this.dl(t.d))i=this.df(t.d);else{_j.e.a(_a.a.f,"Constructing LinkPreview object for {0}",n.href);i=new _g.ez}t.e&&(i.Title=t.e.innerText);t.c&&(i.Description=t.c.innerHTML);i.Url=n.href;i.ImageUrl=t.g;i.IsVideo=_b.l.a(t.b.id,"LPBorder_YT")||_b.l.a(t.b.id,"LPBorder_VT");r=this.bF(i,null,null);_j.e.a(_a.a.f,"Finished creating narrow format preview for {0}",n.href);return r},dd:function(n){if(this.F.a().eX().Enabled&&n&&n.id&&n.id.endsWith("_summary")){var t=window.document.createElement("div");t.innerText=_u.n.Be;t.style.marginRight="10%";t.style.fontSize="12px";t.style.lineHeight=20+"px";t.style.cssText+=this.z("ms-font-m ms-font-color-neutralSecondary",["color","font-weight","font-family"]);_j.k.a(t,"float","right");var i=_b.l.b(n);i.appendChild(t);t.appendChild(this.ca(!0));t.appendChild(this.ca(!1))}},ca:function(n){var t=window.document.createElement("div");t.style.cursor="pointer";_j.k.b(t,"mouseenter",this.bY);_j.k.b(t,"mouseleave",this.bZ);if(n){t.style.marginLeft="10px";_j.k.d(t,_lp.d.d().a());_j.k.b(t,"click",this.bX)}else{t.style.marginLeft="5px";_j.k.d(t,_lp.d.c().a());_j.k.b(t,"click",this.bW)}return t},dn:function(n){n.b()&&this.cd(n.b(),!0)},dm:function(n){n.b()&&this.cd(n.b(),!1)},cd:function(n,t){n.style.cssText+=this.z("ms-font-color-neutralDark",["color"]);n.setAttribute("clicked","true");for(var r=_j.k.L(n,"div"),i=0;i<r.length;i++)if(r[i].getAttribute("clicked")==="true"){r[i].setAttribute("clicked","false");r[i].style.cssText+=this.z("ms-font-color-neutralSecondary",["color"])}var u=new _a.l;var e=_a.b.b(_a.a.f,"ReadingPaneLinkPreviewAction",!1,null);var f=_b.l.b(n).querySelector("a[id^='LPUrlAnchor']");f?u.b("U",_mco.d.b(f,"href",100)):_j.e.b(_a.a.f,"[ReadingPanePreviewBuilder: ProcessLinkSummarizationButtonClicked] Url was not found");u.c("Liked",t);e.m=u.toString();_a.b.a(e)},dp:function(n){if(n.b()){var t=n.b();t.style.cssText+=this.z("ms-font-color-neutralDark",["color"])}},dq:function(n){if(n.b()){var t=n.b();t.style.cssText+=n.b().getAttribute("clicked")==="true"?this.z("ms-font-color-neutralDark",["color"]):this.z("ms-font-color-neutralSecondary",["color"])}},df:function(n){for(var e=new _gg.O,f=new _j.q,u=0;u<n.children.length;u++){var t=n.children[u];if(_b.l.a(t.id,"LPImageAnchor")){var i=new _g.cK;var r=null;r=t.children[0].tagName.toLowerCase()==="span"?t.children[0].children[0].src:t.children[0].src;i.ThumbnailUrl=r;i.ImageUrl=r;i.PhotoPageUrl=t.href;f.c(i)}}e.Photos=f.i();return e},dl:function(n){return n?_b.l.a(n.id,"LPImageAlbumContainer")||_b.l.a(n.id,"LPBestFitImageContainer")?!0:!1:!1},N:function(n){var t=n.getAttribute("PreviewInformation");if(t===(3).toString()){_j.e.a(_a.a.f,"Adding YouTube handler for {0}",n.href);_j.k.b(n,"click",this.bo)}else if(t===(4).toString()||t===(5).toString()){_j.e.a(_a.a.f,"Adding OEmbed video handler for {0}",n.href);_j.k.b(n,"click",this.bl)}else if(t===(2).toString()){_j.e.a(_a.a.f,"Adding handler for {0}",n.href);_j.k.b(n,"click",this.bn)}},dr:function(n){var t=n.getAttribute("PreviewInformation");if(t===(3).toString()){_j.e.a(_a.a.f,"Removing YouTube handler for {0}",n.href);_j.k.c(n,"click")}else if(t===(4).toString()){_j.e.a(_a.a.f,"Removing oembed video handler for {0}",n.href);_j.k.c(n,"click")}else if(t===(2).toString()){_j.e.a(_a.a.f,"Removing handler for {0}",n.href);_j.k.c(n,"click")}this.cc.f()},dt:function(n){var t=n.querySelectorAll("a[id^='LPImageAnchor'] img");t&&t.length===1&&_j.B.c(t,"load")},bT:function(n){n.setAttribute("PreviewInformation",2);this.N(n)},bR:function(n,t){var i=3;t===1?i=3:t===2?i=4:t===3&&(i=5);n.setAttribute("PreviewInformation",i);this.N(n)},bQ:function(n){n.setAttribute("tabindex","-1")},bk:function(n){var f=n;var t=n.parentNode;if(!t){_j.e.a(_a.a.f,"Anchor parent is null for {0}. Skipping rest of FixAnchor",n.href);return n}if(_b.l.a(n.id,"LPUrlAnchor")&&t.tagName.toLowerCase()==="pre"){_j.e.a(_a.a.f,"Anchor parent is not Div for {0}",n.href);var i=window.document.createElement("div");i.id=_lp.a.a("LPTitle");this.x(i,5);var e=n.cloneNode(!0);i.appendChild(e);var r=t.parentNode;if(!r){_j.e.c(_a.a.f,"Anchor grandparent is null for {0}.",n.href);return n}r.replaceChild(i,t);f=e;_j.e.a(_a.a.f,"Replaced anchor parent with Div for {0}",n.href)}else if(_b.l.a(n.id,"LPUrlAnchor")&&t.tagName.toLowerCase()==="span"&&t.parentNode&&t.parentNode.tagName.toLowerCase()==="font"&&t.parentNode.parentNode&&_b.l.a(t.parentNode.parentNode.id,"LPTitle")){var u=t.parentNode.parentNode;this.x(u,5);this.x(n,7);var o=t.parentNode;u.innerHTML=o.innerHTML;_j.e.a(_a.a.f,"Replaced title child with anchor for {0}",n.href)}return f},c:function(n,t,i,r,u){for(var e=t,l=!1,p=0,s=[],c=[],w=[],h=0;h<n.length;h++){var f=n[h];var o=f;if(_b.l.a(f.id,"LPNoLP")||_b.l.a(f.id,"NoLP")){_j.e.a(_a.a.f,"Message was created in compose; no previews will be generated");e=!1}else if(_b.l.e(f.id)){_j.e.a(_a.a.f,"Message was created in compose; no previews will be generated hashtag and mentions");e=!1}else if(_b.l.a(f.id,"LPlnk")||_b.l.a(f.id,"lnk")){_j.e.a(_a.a.f,"Preview request was generated; no previews will be generated");e=!1}else if(_b.l.a(f.id,"LPImageAnchor")){var k=_b.l.d(o);this.cb(o,t,k);this.dj(o,t);if(i==="Mouse"||i==="TouchWide"){_j.e.a(_a.a.f,"Message has previews created in compose; no previews will be generated");l=!0;e=!1;this.bk(o)}}else if(_b.l.a(f.id,"LPUrlAnchor")){var a=_b.l.d(o);this.cb(o,t,a);if(t&&!a)if(i==="Mouse"||i==="TouchWide"){_j.e.a(_a.a.f,"Message has previews created in compose; no previews will be generated");l=!0;e=!1;this.bk(o)}else{var v=_b.l.b(o);if(v){var y=this.de(o);if(y){Array.add(c,y);Array.add(w,v)}}}}else if(e){_j.e.a(_a.a.f,"AnchorTagProtocolsToInterceptForLinkPreview is non-null; checking links");if(this.dk(f,_lp.e.a)){p++;e=p<=1;if(e){var b=this.di(f,t,u);b&&Array.add(s,b)}else _j.e.a(_a.a.f,"Message has more than one link; no previews will be generated")}}}l&&this.dh(u);if(e&&s.length>0){_j.e.a(_a.a.f,"Setting get link preview requests for count: {0}",s.length);r(s)}c.length>0&&this.db(w,c);var d=this;this.l(function(n){var t=[];Array.add(t,n);r(t)})},dh:function(n){var i=n.querySelectorAll("[id^='LPBorder']");if(i&&i.length>0)for(var u=0;u<i.length;u++){var f=!1;var r=!1;var c=i[u];var t=_lp.c.b(c);if(t){var h,e,o;o=this.dg(t,h={val:f},e={val:r}),f=h.val,r=e.val,o;if(t.c){var s=t.c;f?this.o(s):r&&this.bA(this.cE(s))}}}},cb:function(n,t,i){t?i&&this.N(n):this.dr(n)},di:function(n,t,i){var r=null;t&&(r=this.dc(n,i));return r},dc:function(n,t){var i=null;if(!_b.l.d(n)&&this.s(n)&&!this.da(n,t)){_j.e.a(_a.a.f,"Creating link preview request for {0}",n.href);n.id=_b.l.f();this.ds(n);i=new _g.cH;i.Id=n.id;i.Url=n.href;_mco.d.g(i)}return i},da:function(n,t){for(var r=!1,i=n,u=0;u<10;u++){i=i.parentNode;if(!i||i===t)break;var f=i.tagName.toLowerCase();switch(f){case"td":case"tr":case"table":_j.e.a(_a.a.f,"Anchor {0} is in a table",n.href);r=!0;break}if(r)break}return r},dj:function(n,t){if(!t){var i=_b.l.b(n);i&&this.dt(i)}},dk:function(n,t){var f=!1;var r=null;try{r=n.protocol}catch(c){var e=n.outerHTML;var s=e?" OuterHTML: "+e:"";_j.e.c(_a.a.f,"IsLinkPreviewProtocol exception: "+c.message+"."+s)}if(r)for(var u=t,h=u.length,i=0;i<h;++i){var o=u[i];if(r===o){f=!0;break}}return f},db:function(n,t){for(var i=0;i<n.length;i++){var r=n[i];r.parentNode.replaceChild(t[i],r)}},bc:function(){return!0}};_lp.n=function(){};_lp.n.prototype={F:null,b:function(){return this.F},u:function(n){this.F=n;return n},B:!1,h:function(){return this.B},s:function(n){this.B=n;return n},C:!1,i:function(){return this.C},t:function(n){this.C=n;return n},D:null,p:function(){return this.D},l:function(n){this.D=n;return n},E:null,q:function(){return this.E},m:function(n){this.E=n;return n},w:!1,c:function(){return this.w},e:function(n){this.w=n;return n},x:!1,d:function(){return this.x},f:function(n){this.x=n;return n},y:null,n:function(){return this.y},j:function(n){this.y=n;return n},z:null,o:function(){return this.z},k:function(n){this.z=n;return n},G:!1,r:function(){return this.G},v:function(n){this.G=n;return n},A:null,a:function(){return this.A},g:function(n){this.A=n;return n}};_lp.c=function(){};_lp.c.b=function(n){var t=new _lp.l(n);t.g=n.querySelector("div[id^='LPTitle']");t.e=n.querySelector("div[id^='LPDescription']");t.d=n.querySelector(_j.h.c("[id^='{0}']","LPOverlayID"));t.a=n.querySelector("div[id*='Image']");var r=n.querySelector(_j.h.c("[id^='{0}']","LPContainer"));r&&(t.f=r.querySelector("tr"));var u=r?"a[id^='LPUrlAnchor']":"a[id^='LPImageAnchor']";var i=n.querySelector(u);i&&i.tagName&&i.tagName.toUpperCase()==="A"&&(t.c=i);_lp.c.f(t)||(t=null);return t};_lp.c.a=function(n){var i=null;var t=_b.l.b(n);t&&(i=_lp.c.b(t));return i};_lp.c.f=function(n){var r=n.c;if(!r||!_lp.c.d(n.b,r)||n.a&&!_lp.c.e(n.a,r))return!1;if(n.f){var e=n.b.children[0];if(!_lp.c.c(e,"table")){_j.e.a(_a.a.f,"ValidatePreview: Parent is not a table for {0}",r.href);return!1}}for(var f=n.b.getElementsByTagName("div"),i=0;i<f.length;i++){var t=f[i];var u=t.id;if(_b.l.i(u))continue;else if(t.innerHTML.indexOf("inlineimageplaceholder.png")!==-1||t.innerHTML.indexOf("OWATemporaryImageDivContainer")!==-1){i=i+t.getElementsByTagName("div").length;continue}else if(t.innerHTML.indexOf("LPFullsizeImageID")!==-1||t.innerHTML.indexOf("LPThumbnailImageID")!==-1)continue;else if(t.children&&t.children.length>0&&!_b.l.i(t.firstChild.id)){_j.e.a(_a.a.f,"ValidatePreview: Unexpected div with id {0} found for {1}",u,r.href);return!1}}return!0};_lp.c.d=function(n,t){if(!n){_j.e.a(_a.a.f,"ValidateBorder: Border element id is null for {0}",t.href);return!1}if(!_b.l.a(n.id,"LPBorder")){_j.e.a(_a.a.f,"ValidateBorder: Border element id is invalid for {0}",t.href);return!1}if(!_lp.c.c(n,"div")){_j.e.a(_a.a.f,"ValidateBorder: Border element tag name is invalid for {0}",t.href);return!1}if(n.children.length!==1&&n.children.length!==2){_j.e.a(_a.a.f,"ValidateBorder: Border element child count is invalid for {0}",t.href);return!1}return!0};_lp.c.e=function(n,t){var i=n.id;if(_b.l.a(i,"LPImageContainer")||_b.l.a(i,"LPBestFitImageContainer")||_b.l.a(i,"LPImageAlbumContainer")||_b.l.a(i,"LPODImageContainer"))return!0;else{_j.e.a(_a.a.f,"ValidateImageContainer: Image container element id is invalid id {0}",t.href);return!1}};_lp.c.c=function(n,t){return!!n&&!!n.tagName&&n.tagName.toLowerCase()===t.toLowerCase()};_lp.a.registerClass("_lp.a",null,_b.cn);_lp.f.registerClass("_lp.f",null,_b.I);LinkPreviewComponent.registerClass("LinkPreviewComponent",null,_a.kd,_j.ce);_lp.g.registerClass("_lp.g",null,_b.co);_lp.l.registerClass("_lp.l");_lp.o.registerClass("_lp.o");_lp.k.registerClass("_lp.k",_lp.o);_lp.h.registerClass("_lp.h",_lp.o);_lp.i.registerClass("_lp.i",_lp.o);_lp.e.registerClass("_lp.e",_lp.a);_lp.m.registerClass("_lp.m",_lp.e);_lp.a.j="data:image/";_lp.a.h="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo5MDE0MDIyZC00NzE1LTFkNGUtYTQ2Ny00ZjRkODMxYzU1NjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEQ2RDQ5NzMzMTZGMTFFNUIxRDRDOEM3RjY3MkY2MUIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEQ2RDQ5NzIzMTZGMTFFNUIxRDRDOEM3RjY3MkY2MUIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY2Y2U5YmFhLWY0NTAtZTc0Yi05ZWUwLWFiNmRmNTEzNjFjMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5MDE0MDIyZC00NzE1LTFkNGUtYTQ2Ny00ZjRkODMxYzU1NjgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5VyyW6AAADHklEQVR42mL8//8/w2AGTAyDHIw6cNg7kAWZw8jISFXD356oqwNSjUQq/wvEcULmjctQREG5GIap7bi3Jxv+/Hp/+z8x4Nvjff+Bev4guweEaRLF4JBjZKrjVYtmZhVQIUoPp4wjiGKmeRokx3F0yyTUdhxGJgFaIAekDgCxItkm/v/H8PnmYpoVM5Q5jg7l4KBy3GhNMurAUQeOOnDUgUOtwUpl8O/hy1/+M7e+ucXExCDFDGwNMzIxMEoJsX7wMufzlxFhqyNkAKgBTZMQ/P3n/5Si6Q/Fpm56rfbn7/8jgkJi+/kERfeJS8rvvfPs59ZJ61/f/v7rnwPBdgewwUqLELxTOfdJHQsLyzJFRUWP1NRUBjExMbjky5cvJZYvX764fuGViR3J0m7A0N1F1zS4/sh7oKVME62trT0qKipQHAcC4uLiDLm5uQzGxsb5FXOf6jIyscXSzYFvPv7xO379m4akpGRsXFwcAzMzM1Z1IPGkpCQGYWHhrtKZ9/cBhbSA+DTWdIjcWXp3sp6inlPjoqeiX38yrASGkJO+vj5B9Tt27GBYs2bNeiCzH4hfAPEfIH4CxPxz5859Q+1c/OPLj/+fOTk57XV0dIjSAEwGDED1gbdv3w58//49g6CgIAOQzfD27dtNycnJqUBHvqKaA4G5dQqwWDAERi8zrqhFB7y8vAz29vZgDC+b/v1j2Lp1q9/GjRsVgY40pdiBf//9X3Xs6pf2zSc+8QO5E11cXCirOYDZ2tfXl+HNmze6R48ezaPIgcAEe6liztMMYMhNkZOTi7KysmIwNTWlSoyAQhXowBCKHHjhzrdsoOOKzczMooDRwUBs1BIDJCQkQJQKRQ7ceebjTSC1MTw8nKqOg6VFUAqiqBw0UuH6CCoSODg4qF4dgXIzEJxCCUEh80aShrd2zUxSACbqg2fPnnUCpT9qgW/fvjGsWLECxJxOaS5+CsTJS5cuvfj7928+UOEsICBAtmGfP38Gh9zq1atBZWETsBzcykjJsBtsPBGYQUBDJu1AbElh5/81EB8BhRzQcbsxqrrRFjUZACDAABMKUHGGjz9/AAAAAElFTkSuQmCC";_lp.a.l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuOWwzfk4AAAG6SURBVHhe7dCxbSRREMRQuUrtorwYLsG9WbdAT4TQC9B4Do2Z6v/1er3yCzDGhzE+jPFhjA9jfBjjwxgfxvgwxocxPozxYYwPY3wY48MYH8b4MMaHMT6M8WGMD2N8GOPDGB/G+DDGhzE+jJ/o+8+/v4/XT+w3TRg/zfNIP37kt/2uCeMneR5IeeS3/bYJ46d4Hkd75Lf9vgnjJ3geRn3kt/2HCaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5sw2uioi3a3CaONjrpod5swxocxPozxYYwPY3wY48MYH8b4MMaHMT6M8WGMD2N8GOPDGB/G+DDGhzE+jPFhjA9jfBjjwxgfxvgwxocxPozxYYwPY3wY48MY2+vrP6Ok5QzJOY3aAAAAAElFTkSuQmCC";_lp.a.b=!0;_lp.a.d=null;_lp.a.e=_lp.d.e().a();_lp.a.f=_lp.d.f().a();LinkPreviewComponent.$$cctor();_lp.b.b=null;_lp.e.a=["http:","https:"];
window.scriptsLoaded['microsoft.owa.core.linkpreview.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.linkpreview.js'] = (new Date()).getTime();
