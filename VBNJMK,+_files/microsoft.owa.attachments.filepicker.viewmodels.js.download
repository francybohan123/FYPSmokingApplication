window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.attachments.filepicker.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_am");_am.P=function(){};_am.P.prototype={b:function(n){return new _am.C(n,"groupId_"+n)},a:function(){return!1}};_am.z=function(){};_am.z.registerInterface("_am.z");_am.I=function(){};_am.I.registerInterface("_am.I");_am.C=function(n,t){_am.C.initializeBase(this);this.e=n;this.d=t};_am.C.prototype={e:null,d:null,a:function(){return this.d},c:function(){return!1},b:function(n){return n}};_am.K=function(n,t,i,r,u){_am.K.initializeBase(this,[n,null,null,r]);var f=this;this.z(new _j.g(function(){u(t,i)},_a.a.c))};_am.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.dV=Function.createDelegate(this,this.jI);this.fB=Function.createDelegate(this,this.jJ);this.fA=Function.createDelegate(this,this.jH);this.hj=Function.createDelegate(this,this.jE);this.hk=Function.createDelegate(this,this.jF);this.hl=Function.createDelegate(this,this.jM);_am.d.initializeBase(this,[n,t,i,r,u,f,e,o,s,l,a]);this.fC=h;this.cR();c&&this.hi(c.Response);this.dX=!!this.br&&this.br.a().fT().Enabled;this.bQ=!!this.br&&this.br.a().co().Enabled};_am.d.c=function(){return"AttachmentNotification"+(_a.d.a().h()+_ff.p.a(0,1e3)).toString()};_am.d.prototype={fC:null,dY:null,H:null,J:null,w:!1,fE:!1,dZ:null,cE:null,dW:!1,dX:!1,bQ:!1,gn:function(){return this.cz()?this.gp():_at.b.prototype.gn.call(this)},ci:function(){return!this.bO.a().J()||!_j.h.a(this.bp.c())||_y.F.isInstanceOfType(this.bo.c)||!this.jG()?!1:_at.b.prototype.ci.call(this)},jG:function(){return!!this.d()&&!!this.d().a&&_at.l.c(this.d().b)},d:function(){if(!this.dZ){var u=_am.c.a;if(u)for(var f=u,e=f.length,r=0;r<e;++r){var t=f[r];if(_g.q.toString(t.bH.Type)===_g.q.toString(0)){var i=new _a.P(t.bH.EndPointUrl);var n;this.dZ=(n=new _am.d.b,n.e=t.bH.Id,n.c=i,n.a=String.format("{0}://{1}",i.b,i.a),n.d=t.bH.DocumentLibrary,n.b=_g.q.toString(0),n);break}}}return this.dZ},cz:function(){return _dg.c.isInstanceOfType(this.bo)||_dg.d.isInstanceOfType(this.bo)&&_y.F.isInstanceOfType(this.bo.c)&&!this.bo.c.f()},iD:function(){return!this.by||!this.gp()},gh:function(){if(this.cz()){var n;return _dg.c.isInstanceOfType(this.bo)&&!_j.h.a(n=this.bo.bH.AttachmentPreviewUrl)?n:this.bq()?this.bN+"&isImagePreview=True":null}else return _at.b.prototype.gh.call(this)},ix:function(){var n;return _dg.c.isInstanceOfType(this.bo)&&!_j.h.a(n=this.bJ)?n:null},gj:function(){return this.cz()?null:_at.b.prototype.gj.call(this)},cL:function(){return this.cz()?null:_at.b.prototype.cL.call(this)},Y:function(){return this.cz()?null:_at.b.prototype.Y.call(this)},o:function(){this.dY||(this.dY=_am.d.c());return this.dY},hh:function(){return"AttachmentProviderItemViewModel"},cU:function(){return _dg.c.isInstanceOfType(this.bo)&&_j.h.a(_a.bc.a(this.bo.bH.Name))&&this.bo.bH.ContentType==="application/onenote"?!1:_dg.c.isInstanceOfType(this.bo)||_at.b.prototype.cU.call(this)},ez:function(n){if(_dg.c.isInstanceOfType(this.bo)||_dg.d.isInstanceOfType(this.bo)&&_y.F.isInstanceOfType(this.bo.c))if(_dg.d.isInstanceOfType(this.bo)){_j.e.a(_am.d.a,"Uploading attachment from attachment data provider.");this.jB(this.bo.c)}else if(_y.F.isInstanceOfType(this.bo.c)){_j.e.a(_am.d.a,"Sharing attachment from attachment data provider.");this.hm(this.bo.c)}else{_j.e.a(_am.d.a,"Uploading local file to attachment data provider so it can be shared.");_at.b.prototype.ez.call(this,n)}else{_j.e.c(_am.d.a,"Unsupported upload type.");n(null)}},ew:function(){var n=0;if(_dg.c.isInstanceOfType(this.bo)){var i,t;(t=_db.m.e(this.bo,i={val:n}),n=i.val,t)||(n=this.gv()?10:this.bs.b?3:6)}else n=_at.b.prototype.ew.call(this);return n},cR:function(){if(!this.dW){var t=!!this.bq()&&!!this.bq().bH.AttachLongPathName;var n=null;if(t){this.lH(_db.m.l(this.bq(),this.fC));n=this.bO.g(this.bq().bH.ProviderType)}if(!this.jN(n)){if(this.bS&&this.cU()&&this.bo.bH.AttachmentId&&t&&!this.bq().l()){this.cP(this.gP(this.bS.c(this.bq().bH.ProviderType,this.bo.bH.AttachmentId.Id,this.bq().bH.AttachLongPathName,this.bC,this.cM())));this.ij()&&this.cP(this.bN+"&isDocumentPreview=True");return}_at.b.prototype.cR.call(this)}}},eh:function(n,t){_at.b.prototype.eh.call(this,n,t);if(t==="AttachLongPathName"){this.cR();this.eH("HoverText")}else t==="Name"&&this.eH("HoverText")},fV:function(){if(!this.J||this.fE||this.cZ)_at.b.prototype.fV.call(this);else{this.gR(!0);this.cE&&_at.f.p(this.cE,null);this.il(null)}},fd:function(n){this.H=n;this.jL()},gL:function(n){_j.s.c(!!this.br&&!this.br.a().b().Enabled,"upsell with blob is only enabled for Office365 users as of now.");this.J=n;this.bK||this.cn(10);this.cg===1||this.bK>0?this.hn():this.jD()},jL:function(){this.fz();var n=null;if(this.bp.c()){if(this.dd&&this.dd.a(this.bp.c(),"AttachmentGetOneDriveUploadFolderProps")){n=_at.n.d(this.bp.c());if(!n){var r=this;var u=function(n){var t=n.h;_j.e.a(_am.d.a,String.format("Getting upload folder id succeeded. Id: {0}",t));r.fD(t)};var t=this;var i=function(n){_j.e.a(_am.d.a,"Getting upload folder id failed");t.fD(null)};this.jK(this.bp.c(),u,i);return}}}else n=_at.n.d("PersonalOneDriveKey");this.fD(n)},fD:function(n){if(_j.h.a(this.H))_j.e.c(_am.d.a,"Either blob or base64 content needs to be provided for upload.");else{_j.e.a(_am.d.a,"Submitting action CreateReferenceAttachmentFromLocalFileAction with folderID: "+n);this.w=!1;var t=new _ao.c(this.bp.b(),this.bo.bH.Name,this.H,n,this.o(),this.bp.c(),this.bL(),this.bU?this.bU.b():this.H.length,this.cg,this.bK,this.cX(),this.bp.q());t.b(this.fG);t.c(this.fy);this.bF.a(t)}},hf:function(){this.fz();this.w=!1;this.fm.a()},io:function(){if(!_j.h.a(this.cy)){this.jA();this.cr(this.cT,this.cy,!1)}},jz:function(n){if(n.Item){var u=!1;var r=this.bo.c;r&&_y.F.isInstanceOfType(r)&&(u=r.m());var i=n.Item;var t;var f=(t=new _db.d,t.s(i.Name),t.t(i.Size),t.D(""),t.p(i.AttachmentProviderId),t.q(_g.q.toString(i.ProviderType)),t.u(i.Location),t.r(i.Id),t.w(i.ParentId),t.x(i.ProviderEndpointUrl),t.C(i.Thumbnail?i.Thumbnail.Url:null),t.B(i.Preview?i.Preview.Url:null),t.v(this.w),t.A(u),t.z(!1),t);this.bo.c=f}},fv:function(){this.gS(!this.by&&this.bt.t()&&_dg.c.isInstanceOfType(this.bo)&&!this.bo.bH.AttachmentId&&!this.bo.c)},jN:function(n){if(this.br&&this.br.a().gl().Enabled&&this.bq()){if(this.cU()&&!this.bN&&this.bq().bH.AttachmentId&&!this.bq().l()&&n){this.dW=!0;var t=this;n.R(this.bq(),this.bC,this.gW,this.hl,function(){t.lE(!0)})}return!0}return!1},jM:function(n,t,i){this.dW=!1;this.cP(this.gP(n));if(this.ch()&&this.bq()){this.bq().C(i);this.bq().D(t);this.dQ()}},jB:function(n){this.fz();this.w=!0;_j.e.a(_am.d.a,"Submitting action CreateAttachmentFromAttachmentDataProviderAction.");this.bo.a()&&(this.cd=this.bp.E(this.bo.bH.Name,0,0));var t=new _ao.b(this.bp.b(),n.c(),n.g(),n.e(),this.o(),this.bp.c(),n.i(),n.h(),this.bL(),this.cX(),this.bo.a(),this.bp.q());t.c(this.fy);this.bF.a(t)},hm:function(n){this.w=!1;var t=new _at.ba(this.bp.b(),n.c(),n.g(),n.e(),this.bp.c(),n.i(),n.h(),this.bL(),n.j(),n.o(),n.l(),this.cX(),this.bo.bH.ContentType,this.bp.q());t.b(this.hk);t.c(this.hj);this.bF.a(t)},jF:function(n){var i=n.n;var t=this.hi(i);t&&this.cr(1,t,!0);this.cw(n)},jE:function(n){this.em(n);this.cw(null)},jK:function(n,t,i){var r=new _at.n(n);r.b(t);r.c(i);this.bF.a(r)},jH:function(n){var t=Math.round(n.loaded*100/n.total);this.iN(t)},jJ:function(n,t){this.im(null);if(t&&!this.bX){this.fE=!0;this.jC(n)}},jI:function(n){this.cr(1,n.message,!0);this.cw(null)},hn:function(){_j.e.a(_am.d.a,"Submitting XHR file upload request");this.w=!1;this.cg===1?_at.f.n(this.d().a,this.bp.i(),this.ef,this.bo.bH.Name,this.J,this.fA,this.fB,this.dV,!1,this.dX,this.bQ,null):_at.f.o(this.cE,this.J,this.bK,10485760,this.bU.b(),this.fA,this.fB,this.dV,this.bQ,null,null)},jD:function(){var n=this;var t=function(t){n.cE=t;n.hn()};_at.f.g(this.d().a,this.bp.i(),this.ef,this.bo.bH.Name,t,this.dV,!1,this.dX,null)},jC:function(n){var i=null;if(this.bQ)i=n.webDavUrl;else{var u=_j.h.a(this.bp.i())?"":"/"+this.bp.i();i=_j.h.c("{0}{1}{2}/{3}",this.d().c.toString(),this.d().d,u,n.name)}var t;var r=(t=new _db.d,t.s(n.name),t.t(n.size),t.D(""),t.p(this.d().e),t.q(this.d().b),t.u(i),t.r(n.id),t.w(n.parentReference.id),t.x(this.d().c.toString()),t.C(null),t.B(null),t.v(!1),t.A(!0),t.z(!1),t);this.hm(r)}};_am.d.b=function(){};_am.d.b.prototype={c:null,d:null,a:null,e:null,b:null};_am.D=function(n,t,i,r,u){this.e=n;this.d=t;this.g=i;this.f=r;this.c=u};_am.D.prototype={e:null,d:null,g:null,f:null,c:null,h:0,a:function(n,t,i,r,u,f,e,o){!this.c.e.h()&&++this.h<=3&&this.g.c();var s=_at.z.a(this.f,this.c,u);return new _am.d(n,t,i,r,u,f,e,o,this.e,this.d,null,s,this.c)},b:function(n,t,i,r,u,f,e,o,s){var h=_at.z.a(this.f,this.c,u);return new _am.d(n,t,i,r,u,e,o,s,this.e,this.d,f,h,this.c)}};_am.i=function(n,t,i,r,u){this.d=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.f);_am.i.initializeBase(this);this.a=n;this.c=i;this.b=u;if(r.a()==="TouchNarrow")this.fk(this.g());else{var f=_y.h.a(_ufp.A.Z,this.fj);this.fe(_y.k.a(this,[f],null))}this.a.f.j.e(this.e);this.a.f.apcl("BreadCrumbs",this.d)};_am.i.prototype={a:null,c:null,b:null,n:function(){return 1},h:function(){if(!this.a.f.j)return null;for(var t=this.a.f.j,r=t.x.length,i=new _j.l,n=1;n<=2&&r-n>=0;n++)i.t(0,t.x[t.x.length-n]);return i},fD:function(){this.a.D(null);_y.lJ.prototype.fD.call(this)},f:function(n,t){this.eH("BreadCrumbs")},i:function(n,t){this.f(null,null)},g:function(){var n=this.b.b();n.d(_ufp.A.BV);if(this.c.a()){n.a(this.b.a(_y.b.b(),_y.b.b(),this.fj,""));n.e(3)}else n.a(this.b.a(_y.b.a(),_y.b.a(),this.fj,""));return n}};_am.g=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){this.cC=Function.createDelegate(this,this.dA);this.bQ=Function.createDelegate(this,this.dB);_am.g.initializeBase(this,[n,t,i,r,null,null,f,e,o,s,h,c,l,a,v,y,p,b,w]);this.bS=u;this.f.K(this.bQ);this.bV=c;this.Y=k};_am.g.prototype={bS:null,bu:null,bs:null,bv:null,cD:!1,bV:null,Y:null,eF:function(){return this.cD},bT:function(){this.bu||(this.bu=new _j.g(this.cC,_a.a.c));return this.bu},br:function(){return null},cr:function(){return null},l:function(){if(!this.bs){var n=_y.h.a(_ufp.A.Z,this.bT());this.bs=_y.k.a(this,[n],null)}return this.bs},bR:function(){return null},u:function(){this.bv||(this.bv=this.dz());return this.bv},n:function(){return 1},dw:function(){this.cE()},B:function(){_am.b.prototype.B.call(this);this.cE();this.f.br(null);this.f.bu(null)},bB:function(){return!1},M:function(){_am.b.prototype.M.call(this);var n=!!this.f.d||this.s||this.O||this.v;this.bc&&n&&this.bc.e(this.bS.e())},dA:function(){this.H.a()},cE:function(){this.dn(!1);this.dq(!1);this.dp(!1);this.D(null)},dB:function(){this.dy();this.f.bP(this.bQ)},dz:function(){var n=this.Y.b();n.d(_ufp.A.e);if(this.bV.a()){n.a(this.Y.a(_y.b.b(),_y.b.b(),this.bT(),""));n.e(3)}else n.a(this.Y.a(_y.b.a(),_y.b.a(),this.bT(),""));return n}};_am.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){this.cH=Function.createDelegate(this,this.dH);this.cI=Function.createDelegate(this,this.ea);this.cF=Function.createDelegate(this,this.dC);this.cS=Function.createDelegate(this,this.fi);this.cR=Function.createDelegate(this,this.ds);this.cP=Function.createDelegate(this,this.fg);this.cT=Function.createDelegate(this,this.dt);this.cQ=Function.createDelegate(this,this.dr);this.cO=Function.createDelegate(this,this.fc);this.cK=Function.createDelegate(this,this.ed);this.cL=Function.createDelegate(this,this.eh);this.cG=Function.createDelegate(this,this.B);this.ca=Function.createDelegate(this,this.eo);this.cb=Function.createDelegate(this,this.ep);this.bZ=Function.createDelegate(this,this.em);this.bY=Function.createDelegate(this,this.ek);this.cM=Function.createDelegate(this,this.el);this.cJ=Function.createDelegate(this,this.eb);this.bw=Function.createDelegate(this,this.en);this.bX=Function.createDelegate(this,this.ej);this.cd=Function.createDelegate(this,this.fm);this.cc=Function.createDelegate(this,this.fk);this.bW=Function.createDelegate(this,this.dE);this.ce=Function.createDelegate(this,this.fn);this.cN=Function.createDelegate(this,this.er);_am.b.initializeBase(this);this.f=n;this.w=t;this.w.g=this.cN;this.f.apcl("SelectedDataProvider",this.ce);this.f.apcl("AttachmentDataProviders",this.bW);this.f.apcl("IsOneDriveProGroupsView",this.cc);this.f.apcl("ItemsTable",this.cd);this.f.apcl("BreadCrumbsSelectedItem",this.bX);this.f.bb||this.f.K(this.bw);if(i){var d=this;i.a(function(n){d.eC(n)})}this.ch=r;this.bF=u;this.bz=f;this.dj=e;this.bO=o;this.bC=!!s&&s.a().H().Enabled;this.co=!!s&&s.a().N().Enabled;this.ct=!!s&&s.a().c().Enabled;this.bf=!!s&&s.a().b().Enabled;this.cq=!!s&&s.a().iR().Enabled;this.bD=!!this.bF&&!!v&&!!v.g()&&!!v.g().WacEditableFileTypes&&v.g().WacEditableFileTypes.length>0&&!this.f.R&&!this.f.u;this.bE=!!this.bz&&!!s&&s.a().dM().Enabled&&!!v&&!!v.g()&&v.g().ThirdPartyAttachmentsEnabled;this.bi=h;this.r=s;this.ck=c;this.z=l;this.P=a;this.o=v;this.cg=y;this.cy=k;this.S=p.a();this.R=w;this.da=b;this.ci=p;this.eq(e)};_am.b.a=function(n){return Math.floor(n/1024).toString()};_am.b.b=function(n){return String.format('<img src="{0}" alt="{1}" style="max-width:99.9%" data-fromBingImageSearch="true"/>',n.sourceUrl,n.caption)};_am.b.prototype={ch:null,bF:null,bz:null,bi:null,ct:!1,cq:!1,bD:!1,bE:!1,z:null,P:null,r:null,cy:null,f:null,w:null,bf:!1,co:!1,j:null,bc:null,bb:null,G:null,cn:null,N:null,bo:null,bn:null,H:null,W:null,g:null,bh:!1,bk:null,bl:null,bK:null,bH:null,bC:!1,U:null,cz:null,bM:null,bx:null,h:null,L:null,J:null,Z:null,bp:null,ba:null,V:null,dj:null,bO:null,v:!1,C:!1,bP:!1,bG:0,bL:null,bI:null,O:!1,cu:!1,be:!1,cs:!1,cx:null,bm:null,bN:null,bJ:null,s:!1,bj:null,ck:null,E:null,cw:!1,t:null,q:null,p:null,o:null,cg:null,S:null,cj:!1,R:null,bq:!1,i:0,da:null,ci:null,bg:!1,A:null,eu:function(n){if(this.i!==n){this.i=n;this.cB();this.eP(["ShouldHideSecondaryDataProviders","ShouldShowBingImageSearchButton","LeftButtonText","HideNewOfficeDocumentButton","ShouldHideWopiProviders"])}return n},ev:function(n){if(this.q!==n){this.q=n;this.g.cx(this.q);this.eY();this.bH.a()}return n},dQ:function(){return this.i?_ufp.A.e:_ufp.A.u},D:function(n){if(this.f.d===n)return n;this.ei();this.f.U(n);this.M();this.eH("SelectedDataProvider");return n},dc:function(){return!!this.f.d&&!!this.f.d.a&&this.f.d.a.bH.IsThirdPartyProvider},dR:function(){return this.i===1||!this.f.bb},dU:function(){return this.z.c()?this.z.a():this.P.a()==="TouchNarrow"?!0:this.z.e()||this.z.a()},dT:function(){return this.P.a()==="TouchNarrow"?!1:!this.z.e()&&!this.z.a()},eB:function(n){if(this.W!==n){this.W=n;this.eH("SelectAttachmentDataProviderItemCommand")}return n},cf:null,eE:function(n){if(this.bJ!==n){this.bJ=n;this.eH("ShowCurrentGroupDocumentsCommand")}return n},ez:function(n){if(this.bk!==n){this.bk=n;this.eH("OpenLocalComputerFilePickerCommand")}return n},eA:function(n){if(this.bl!==n){this.bl=n;this.eH("OpenLocalComputerImageFilePickerCommand")}return n},eG:function(n){if(this.bK!==n){this.bK=n;this.eH("ShowFilePickerCommand")}return n},ey:function(n){if(this.bH!==n){this.bH=n;this.eH("OnLocalFilesSelectedCommand")}return n},de:function(){return this.bC&&this.i===1},eD:function(n){if(this.bI!==n){this.bI=n;this.eH("ShowBingImageSearchCommand")}return n},eN:function(n){if(this.bL!==n){this.bL=n;this.eH("ShowGroupsCommand")}return n},eR:function(n){if(this.bN!==n){this.bN=n;this.eH("ShowRecentDocumentsCommand")}return n},eQ:function(n){if(this.bM!==n){this.bM=n;this.eH("ShowNewOfficeDocumentPanelCommand")}return n},et:function(n){if(this.bx!==n){this.bx=n;this.eH("AddAnAccountCommand")}return n},dm:function(n){if(this.g!==n){this.g=n;this.eV("AttachmentWellViewModel","ShowGroupsAsDataProviderEnabled","HideGroupsButton")}return n},dO:function(){return!this.bD||this.i===1||!this.g||!this.g.d()||this.g.d().i()!==1},dS:function(){return!this.bE||this.i===1},dP:function(){return this.P.b()},ew:function(n){(n||this.C)&&(this.bP=!0);if(this.C!==n){this.C=n;n?this.f.cQ():this.f.dg();this.eH("IsBingImageSearchSelected")}return n},dp:function(n){if(this.v!==n){this.v=n;this.eH("IsGroupsSelected")}return n},dd:function(){return this.v&&!this.t},dN:function(){return!this.ct||!this.T()||!this.K()},b:function(n){this.bg=n;return n},dq:function(n){if(this.O!==n){this.O=n;this.eH("IsRecentDocumentsSelected")}return n},dn:function(n){if(this.s!==n){this.s=n;this.eH("IsCurrentGroupSelected")}return n},eC:function(n){if(this.j===n)return n;this.j=n;this.eH("SelectedModernGroupProvider");return n},T:function(){return this.g?!this.g.c()||!!this.bi&&this.bi.a(this.g.c(),"AttachmentShowGroups"):!0},by:function(){return 1},x:function(){return this.cJ},bU:function(){return this.bc},bt:function(n){this.bc=n;return n},y:function(){return this.bb},m:function(n){this.bb=n;return n},bA:function(){return!0},bB:function(){return!0},K:function(){if(this.bj)return this.bj;var t=this.f.e;if(!t)return null;for(var i=this.dY(),n=0;n<t.x.length;n++)if(t.x[n].a.a()===i){this.bj=t.x[n];return this.bj}return null},cl:function(){return!!this.f.d&&Object.getType(this.f.d)===_am.q},ex:function(n){if(this.U!==n){this.U=n;this.eH("OnInsertButtonClickCommand")}return n},a:function(n,t,i,r,u,f,e,o){_a.c.a(n,"attachmentWellViewModel");_a.c.a(r,"onPopupViewModelRequested");this.A=null;_am.a.a=o===1;this.f.bQ(o);if(this.f.J&&n&&this.co){n.g(!1,null,null,null);_j.e.a(_a.a.c,"Suppressing file picker as there are no providers to display.");return}this.dm(n);this.be=e;this.r&&this.r.a().bJ().Enabled||(this.cs=f);if(this.cw!==this.T()||this.i!==o){this.bh=!1;this.X(!1,!1,!1,!1);_at.B.b()}var h=o!==this.i;this.eu(o);this.p=r;if(this.z.b()&&!this.z.m()&&!this.P.b()){var s=this.P;this.p=s.G||(s.G=Function.createDelegate(s,s.C));_a.c.a(this.p,"onPopupViewModelRequested_owaShellPopUpAsPanel")}this.cw=this.T();this.V=t;this.r&&this.r.a().bJ().Enabled?this.cm(i||e):this.cm(i||e||f);this.h.K=this.f.R=!!n.c();this.p&&this.p(this);this.E=u;this.f.C(u);this.f.e&&this.f.e.x.length?h&&this.f.cO():this.f.c();this.g.bg()||this.h.bD(this.g.c(),this.f,this.bi);this.R.J(u);this.j&&this.j.a()&&this.g.cn(this.j.a().bH.DisplayName);this.r&&this.r.a().cp().Enabled&&_at.l.a(0,null,null,null,null);this.bP=!1;this.bG=0},e:function(){if(!this.cu){this.cu=!0;this.f.cL()}},c:function(n,t){var i;i=this.R.T(n);i&&i.d(t[i.O()],t,this.cM,this.f.bA)},d:function(n,t,i,r,u){this.dm(n);var s=null;var o=u;this.r&&this.r.a().bJ().Enabled||(o=o||r);if(!o&&!this.f.J){this.cm(!1);var e=this;s=function(){e.q=e.g.bN();e.Q(!0,i,!0)}}var f=this;this.g.g(!1,null,function(n,t,r){f.h.b=_a.b.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles",!1,null);f.Z=n;f.bp=t;f.ba=r;f.Q(!0,i,!0)},s)},eJ:function(){this.f.rpcl("SelectedDataProvider",this.ce);this.f.rpcl("AttachmentDataProviders",this.bW);this.f.rpcl("IsOneDriveProGroupsView",this.cc);this.f.rpcl("ItemsTable",this.cd);this.f.rpcl("BreadCrumbsSelectedItem",this.bX);this.f.bP(this.bw);var i;_a.h.a(i={val:this.U}),this.U=i.val;var t;_a.h.a(t={val:this.L}),this.L=t.val;var n;_a.h.a(n={val:this.J}),this.J=n.val;this.f.bF();if(this.h){this.h.bp(this.bY);this.h.dispose();this.h=null}this.f&&this.f.cj(this.bZ);_a.gd.prototype.eJ.call(this)},ei:function(){if(this.f.d){this.f.d.bo(this.cb);this.f.d.Y(this.ca)}},M:function(){if(this.f.d){this.X(!1,!1,!1,!1);this.t=null;this.eH("IsMailboxDataProvider");this.w.d();this.f.d.P(this.cb);this.f.d.E(this.ca)}this.cB()},dw:function(){},du:function(){},dx:function(){if(this.V){this.V.m=this.dI();_a.b.a(this.V);this.V=null}},dv:function(){},B:function(){if(this.bb){this.cZ();this.f.bF();this.E=null;this.cv()&&this.w.d();this.eg();this.bb()}},dy:function(){if(!this.dh()){this.ck.a(_a.u,new _a.u([this.f.bJ()],0,null,0,!1,null,null,this.S.U(),this.E,null,null,null));return!1}return!0},eg:function(){if(this.bC&&(this.bP||this.C)){var n=new _a.l;n.a("N",this.bG);_a.b.c(_a.a.c,"AttachmentsFilePickerBingImageSearch",n.toString(),0)}},dh:function(){var n=this.f.e;return!!n&&n.x.length>0},dY:function(){return this.bf?this.f.u?5:1:0},cm:function(n){if(this.bh)this.f.g&&this.f.g.O();else{this.H=new _j.g(this.cG,_a.a.c);this.cz=new _j.g(this.cL,_a.a.c);var s=this;this.G=new _j.g(function(){s.cW(!0)},_a.a.c);this.cn=new _j.g(this.cK,_a.a.c);var h=this;this.N=new _j.g(function(){h.cV(!0)},_a.a.c);this.bo=new _j.g(this.cO,_a.a.c);var o=this;this.bn=new _j.g(function(){o.cV(!1)},_a.a.c);var u=this;this.cf=new _j.g(function(){u.es(u.p)},_a.a.c);var f=this;this.eB(new _j.g(function(){f.dk(f.p)},_a.a.c));var e=this;this.eG(new _j.g(function(){e.fh(e.p)},_a.a.c));var r=this;this.ey(new _j.g(function(){r.h.b=_a.b.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles",!1,null);r.Q(!0,r.p,!1)},_a.a.c));var t=this,i=this;this.ex(new _j.w(function(){if(t.C)t.ec();else{t.h.b=_a.b.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile",!1,null);t.Q(!1,t.p,!1)}},_a.a.c,this.f,"SelectedAttachmentsChanged",function(){return i.C?i.ee():i.cX()}));this.eE(new _j.g(this.cQ,_a.a.c));this.eR(new _j.g(this.cT,_a.a.c));this.eD(new _j.g(this.cP,_a.a.c));this.eN(new _j.g(this.cR,_a.a.c));this.eQ(new _j.g(this.cS,_a.a.c));this.et(new _j.g(this.cF,_a.a.c));this.T()||this.bf?this.dl():this.fb();this.h=this.ch.e();this.h.X(this.bY);this.f.ba=this.R;this.f.n(this.bZ);this.bh=!0}this.cj=n;this.bn.c(!n);this.bo.c(!n);if(this.s&&this.bB()){this.s=!1;this.dr()}},cZ:function(){this.f&&this.f.f&&this.f.f.g()},eq:function(n){n&&!_g.k.b&&n.a("AttachmentOperationCorrelationIdNotification",_a.a.c,"AttachmentsFilePickerPanelViewModel",this.cI,0)},ea:function(n){var t=n;t?this.bO&&this.bO.d(t.CorrelationId,t.SharePointCallName,t.Exception):_j.e.c(_a.a.c,"HandleCorrelationIdNotification: The notification payload is null.")},ek:function(){this.ba&&this.ba()},dG:function(n,t,i){var r;return r=new _db.d,r.s(n.bH.Name),r.t(n.bH.Size),r.D(n.bH.MimeType),r.p(t),r.q(_g.q.toString(n.e())),r.u(n.bH.Location),r.r(n.bH.Id),r.w(n.bH.ParentId),r.x(n.bH.ProviderEndpointUrl),r.C(n.bH.Thumbnail?n.bH.Thumbnail.Url:null),r.B(n.bH.Preview?n.bH.Preview.Url:null),r.v(i),r.A(!n.bH.Size),r.z(n.a()===1),r},cV:function(n){var t=null;if(this.g){this.g.U(this.i===1);this.g.R(_a.b.b(_a.a.c,"AttachmentsFilePickerSelectDestination",!1,null));var r=this.f.d?this.f.d.a.bH.Id:this.K().a.bH.Id;t=[];if(this.f.f){var i=this;this.f.f.o(function(u){var f=i.dG(u,r,n);Array.add(t,f)})}this.eU(n);this.g.P(new _h.cf(t))}this.dK(t);this.dL();this.A=n?"AttachCloud":"ShareCloud";this.B();this.h.H();if(this.h.f){this.cp()?this.o.b().Q(n?1:2):this.o.b().P(n?1:2);this.cA()}},dD:function(){if(this.g){this.g.U(this.i===1);var r=this.fd();if(this.f.f){var n=new _j.q;var i=this;this.f.f.o(function(t){var f=t;var u=null;if(i.di(f)){u=new _dg.c;u.E(_g.q.toString(f.e()));u.A(f.bH.Location)}else r||(u=new _dg.d);if(u){u.e(f.bH.Name);u.f(f.bH.Size);u.g(new _g.bd(f.bH.Id));var e=new _db.E(u,f.bH.ParentId);n.c(e)}});var t=_a.b.b(_a.a.c,"AttachmentAddFPRecentAttachmentsItemAttachments",!1,null);this.g.bC(n,t)}}this.A="Recent";this.B()},eU:function(n){this.g.w(n?this.i?"AttachmentsFilePickerAttachCloudImageFile":"AttachmentsFilePickerAttachCloudFile":"AttachmentsFilePickerShareCloudFile");this.g.L(this.dX());this.g.bu(this.g.bi()?this.h.f:!1);this.g.br(this.dg())},dg:function(){return this.f.d&&this.f.d.a?_g.q.toString(this.f.d.a.a()):this.v||this.s?"Group":this.O?"RecentFiles":"Unknown"},dX:function(){return this.f.d&&this.f.d.a?this.f.d.h():this.v||this.s?"Group files":"Unknown"},dL:function(){this.f.d&&this.f.d.a&&this.f.d.g(this.f.g.bF)},en:function(){this.f.C(this.E);this.eH("ShouldHideSecondaryDataProviderCreators");this.f.bP(this.bw)},dK:function(n){if(n){for(var u=_a.b.b(_a.a.c,"AttachmentsFilePickerFileSelection",!1,null),t=new _a.l,r=new Sys.StringBuilder,i=0;i<n.length;i++){var f=_a.bc.a(n[i].a());r.append(f);r.append(";")}t.a("C",n.length);t.b("T",r.toString());t.b("DP",this.dg());t.c("SRCH",!!this.w.e);u.m=t.toString();_a.b.a(u)}},es:function(n){if(this.cX()){this.h.b=_a.b.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile",!1,null);this.Q(!1,this.p,!1)}else this.dk(n)},er:function(n){this.cZ();var t=!_j.h.a(n);this.f.dd(t);t?this.f.cR(n):this.f.ci()},cY:function(){this.cv()&&this.w.d()},cB:function(){this.w.A(this.cv())},ep:function(n){this.cB()},eo:function(n){this.cY()},fm:function(n,t){var i=this.f.h&&!this.f.h.a?this.f.h.b:null;this.w.C(i)},ej:function(n,t){this.f.S&&this.cY()},dk:function(n){if(this.f.f&&this.f.f.x.length===1){var t=this.f.f.x[0];if(t.a()){if(t.a()===1||t.a()===2){var f=t.bH.Id;var i=null;if(t.a()===2){i=this.f.f.x[0].bH.PagingMetadata;this.t=i.GroupSmtpAddress}else if(this.t){if(i){if(!_gg.bT.isInstanceOfType(i))throw Error.invalidOperation(String.format("GroupsPagingMetadata is NULL. To expand subsequent folders within a Group, a non-null GroupsPagingMetadata is needed. GroupAddress: {0}, FolderName:{1}",this.t,t.bH.Name));}else i=new _gg.bT;i.GroupSmtpAddress=this.t;f=String.format("{0}_{1}",this.t,f)}else this.t=null;this.f.w();var u=this.f.d?this.f.d.c():null;var r=this.f.d;if(this.s||this.v){r=this.K();u=new _gg.bU;u.Type=3}this.w.d();this.f.B(new _at.v(f,t.bH.Location,t.bH.Name,u,t.bH.ProviderEndpointUrl,r?r.a:null),!0,this.f.d?this.f.d.r():null,i)}}else{this.h.b=_a.b.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile",!1,null);this.Q(!1,n,!1)}}},fh:function(n){var t=this;this.g.g(this.i===1,this.i===1?this.bl:this.bk,function(i,r,u){t.h.b=_a.b.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles",!1,null);t.Z=i;t.bp=r;t.ba=u;t.Q(!0,n,!1)},null)},ec:function(){if(this.f){var i=Array.clone(this.f.s);this.f.bF();this.bG=i.length;this.A="BingImage";this.H.b&&this.H.a();for(var r=new Sys.StringBuilder,t=i,f=t.length,n=0;n<f;++n){var u=t[n];r.append(_am.b.b(u))}this.g.ca(r.toString())}},Q:function(n,t,i){if(!n&&this.cl()){this.dD();return}if(this.i===1){this.g.S(!1);n?this.G.a():this.N.a();return}if(this.bg&&!this.f.R&&n){this.G.a();return}if(this.f.u&&n){this.G.a();return}this.fj(n);this.g.S(!1);if(this.bq&&this.G.b&&!this.be){this.h.W(this.cn);this.bq=!1}else{this.h.W(null);this.bq=!1}var f=n?this.G:this.N;var u=n?this.bo:this.bn;var r=this.dW(n,this.cp());if(f.b&&this.ff(r,n,i)){f.a();return}this.bn.c(!this.cj&&(this.f.d?this.f.d.n():!0));if(u.b&&this.fe(r)){u.a();return}this.h.bv(f);this.h.bB(u);this.h.bu(n);this.h.bs(this.cp());this.h.c=this.dF(n);this.h.bw(this.dM());this.h.bz(this.dZ());this.h.bq(!r&&(n||!this.dc()&&!this.cl()));this.h.R(!1);this.h.N=this.p;this.h.O=this.E;this.h.M=this.ci;this.h.i=null;this.g.S(!0);t(this.h)},dM:function(){return this.f.d?this.f.d.t:this.S},ff:function(n,t,i){if(!this.o.g().ClassicAttachmentsEnabled)return!1;if(n===1||!this.dh()||!this.o.g().ReferenceAttachmentsEnabled||this.ef(t))return!0;if(i&&!n){var r=this.df(!0);return r<=5242880}return!1},ef:function(n){return!n&&!!this.f.d&&this.f.d.S()===1},fe:function(n){return(n===2||!this.o.g().ClassicAttachmentsEnabled)&&this.o.g().ReferenceAttachmentsEnabled},eY:function(){if(this.q&&this.cq){for(var n=0;n<this.q.a();n++){var t=this.q.b(n);if(!_at.i.k(t.a()))return}this.bq=!0}},dF:function(n){return n?!!this.q&&this.q.a()>1:!!this.f.f&&this.f.f.x.length>1},dW:function(n,t){return this.dc()?0:n?this.o.b().bH.AttachOrShareLocalFiles:t?this.o.b().bH.AttachOrShareGroupsFiles:this.o.b().bH.AttachOrShareCloudFiles},fj:function(n){this.h.a.r();if(n&&_a.n.a().R)this.db(!0,this.G,this.q.a());else if(this.f.f){this.dJ(this.N);this.N.b&&this.db(!1,this.N,this.f.f.x.length)}if(n&&this.g&&this.g.bg()){this.bo.c(!1);this.h.a.a(10216,this.bd().A())}this.cs&&this.h.a.a(10315);this.be&&this.h.a.a(10204,this.bd().A())},df:function(n){var i=0;if(n)for(var t=0;t<this.q.a();t++)i+=this.q.b(t).b();else if(this.f.f){var r=this;this.f.f.o(function(n){var t=n;i+=t.bH.Size})}return i},dV:function(){var n=0;var i=new _j.q;var t=this;this.f.f.o(function(i){var r=i;t.di(r)||(n+=r.bH.Size)});return n},di:function(n){return!_j.h.a(n.bH.Location)},dJ:function(n){if(this.f.bk){n.c(!1);this.h.a.a(10205,this.bd().A())}else if(this.f.bD){n.c(!1);this.h.a.U(this.bd().I())}else n.c(!0)},db:function(n,t,i){if(this.r&&this.r.a().fV().Enabled&&this.z.q()){var r=this.df(n);var f=this.g.bh();var u=n?this.S.A():this.bd().A();if(r>f*1024){t.c(!1);var o=i===1?10200:10201;this.h.a.a(o,_am.b.a(f),u)}else if(r>5242880){var e=i===1?10202:10203;this.h.a.a(e,_am.b.a(r/1024),u);t.c(!0)}else t.c(!0)}},fd:function(){var i=this.dV();var n=this.g.bh();if(i>n*1024){var t=13306;this.g.C().a(t,_am.b.a(n));return!0}return!1},bd:function(){return this.f.d?this.f.d.t:this.S},dZ:function(){return!this.g.c()||!this.j||!this.j.a()?null:this.j.a().bH.DisplayName},cU:function(){this.g.L("Computer");this.g.br("");this.g.bu(this.g.bi()?this.h.f:!1)},ed:function(){this.g.U(!0);this.cW(!1)},cW:function(n){this.g.R(_a.b.b(_a.a.c,"AttachmentsFilePickerSelectDestination",!1,null));n&&this.g.w(this.i?"AttachmentsFilePickerAttachLocalImageFile":"AttachmentsFilePickerAttachLocalFile");this.cU();this.Z?this.Z():this.g.p().b&&this.g.p().a();this.A="AttachLocal";this.B();this.h.H();if(this.h.f){this.o.b().G(1);this.cA()}},fc:function(){if(this.dy()){this.g.R(_a.b.b(_a.a.c,"AttachmentsFilePickerSelectDestination",!1,null));this.g.w("AttachmentsFilePickerShareLocalFile");this.cU();this.bp?this.bp():this.g.ba()&&this.h&&this.h.i?this.g.ba()(this.h.i.Id,this.h.i.b):this.g.z()&&this.g.z().b&&this.g.z().a();this.A="ShareLocal";this.B();this.h.H();if(this.h.f){this.o.b().G(2);this.cA()}}},cA:function(){_h.f.a(this.o.b().c(),this.cg);this.g.cz();this.h.R(!1)},fg:function(){if(!this.C){this.X(!1,!1,!1,!0);this.D(null)}this.f.q();this.M()},ds:function(){if(!this.dd()&&this.K()){if(!this.v){this.X(!1,!1,!0,!1);this.D(null)}this.f.q();this.f.de(this.K().a);this.f.cn();this.M()}},fb:function(){this.bm=new _at.v("AttachmentsDataProvider_RecentDocuments","",_ufp.A.U,null,null,null);this.bm.a=!0;this.cx=new _ao.f(new(_h.dU.$$(_ao.f))(this.bm));this.bB()&&this.dt()},dt:function(){if(!this.O){this.X(!1,!0,!1,!1);this.t=null;this.D(null);this.f.br(this.bm);this.f.bu(this.cx);this.f.q();this.f.cN();this.M()}},dr:function(){if((!this.s||!this.f.h.a)&&this.j&&this.j.a()){this.X(!0,!1,!1,!1);this.D(null);var i=new _gg.bU;i.Type=3;var n=new _gg.bT;n.GroupSmtpAddress=this.j.a().bH.SmtpAddress;this.t=n.GroupSmtpAddress;var t=new _at.v(this.j.a().bH.SmtpAddress,"",this.j.a().bH.DisplayName,i,null,this.K().a);t.a=!0;this.f.B(t,!0,null,n);this.f.q();this.M()}},dI:function(){var n=new _a.l;n.a("W",this.g.c()?1:0);n.b("A",this.A?this.A:"");return n.toString()},fk:function(n,t){this.f.E&&(this.t=null)},dE:function(n,t){this.eH("HideGroupsButton");this.bh&&this.dl()},fi:function(){if(this.bD){if(!this.L){this.L=this.bF.e();this.L.b=this.cH}this.p(this.L)}},dC:function(){if(this.bE){this.J||(this.J=this.bz.e());this.p(this.J)}},dH:function(n){this.g&&this.g.cc(n,this.be,!0);this.A="CreateNew";this.L.r();this.B()},dl:function(){!this.bf&&!this.T()||this.f.d||!this.bB()||this.s||this.v||this.C||(this.bg?this.ds():this.D(this.K()))},fn:function(n,t){this.M();this.eH("SelectedDataProvider")},ee:function(){var n=!1;this.f.s&&(n=this.f.s.length>0);return n},cX:function(){return this.f.f&&this.f.f.x.length>0?!this.f.d||!this.f.d.a.bH.AllowFolderSharing||this.i===1?!this.f.bk:!0:!1},cp:function(){return this.v||this.s},cv:function(){return this.f.d?!this.f.y&&(!!this.o&&this.o.c().bH.IsShadowMailbox||!!this.r&&this.r.a().kc().Enabled)&&this.f.d.K():!1},el:function(n){this.J&&this.J.r();this.f.cp(n);this.f.C(this.E);this.D(n)},em:function(n){this.f.d===n&&this.D(this.K())},eh:function(){this.B();this.cy.a("/options/attachmentoptions",null)},eb:function(n,t,i){if(!t){this.B();return!0}return!1},X:function(n,t,i,r){this.dn(n);this.dq(t);this.dp(i);this.ew(r)}};_am.n=function(){this.c=Function.createDelegate(this,this.g);this.a=new _a.bG(1e3);_j.e.f||this.f()};_am.n.prototype={a:null,b:!0,f:function(){this.e();this.b=!1},e:function(){this.a.e()},d:function(n,t,i){if(this.b){var r=new _am.n.a;r.b=n;r.d=t;r.c=_a.d.d(_a.d.a());r.a=i;this.a.b(r)}},g:function(n){for(var t=new Sys.StringBuilder,r=0;r<this.a.a.length;r++){var i=this.a.f(r);t.append("\nSharePoint call name: "+i.d);t.append(", Time: "+i.c);t.append(", Correlation Id: "+i.b);_j.h.a(i.a)||t.append(", Exception: "+i.a);n&&t.appendLine("<BR>")}return new _a.bL("Attachments file picker diagnostics data:",t.toString())}};_am.n.a=function(){};_am.n.a.prototype={c:null,d:null,b:null,a:null};function AttachmentsFilePickerViewModelsComponent(){}AttachmentsFilePickerViewModelsComponent.$$cctor=function(){_a.t.a().a(AttachmentsFilePickerViewModelsComponent)};AttachmentsFilePickerViewModelsComponent.onOAuthFinished=function(n){var r=_a.v.d(n);var i=r.provider;if(_j.h.a(i)){var u=r.state;if(!_j.h.a(u)){var t=JsonParser.deserialize(u);t&&"provider"in t&&(i=t.provider)}}var f=_j.u.b(_g.q,i);AttachmentsFilePickerViewModelsComponent.a.c(f,r)};AttachmentsFilePickerViewModelsComponent.prototype={b:function(n,t,i){var v=this;n.b(_am.z,function(){return new _am.v(n.a(_a.q),n.a(_j.j),n.a(_a.e),i)}).a();var a=this;n.b(_am.c,function(){return new _am.c(n.a(_a.q),i.a(),n.a(_a.e),n.a(_at.w),n.a(_j.j),n.a(_am.z),i,!0)}).b(_am.I).a();var l=this;n.b(_am.l,function(){return new _am.l(n.a(_a.q),n.a(_j.j),n.a(_a.e),n.a(_g.h),n.a(_am.z),n.a(_am.c))}).a();var w=this;n.b(_am.h,function(){return new _am.h(n.a(_a.e),n.a(_j.j))}).a();var r=null;if(i.e().a().c().Enabled)if(i.a()==="Mouse"){var p=this;r=new(AttachmentsFilePickerViewModelsComponent.b.$$(_y.jB))(function(){var t=n.a(_y.s);return t?t.g:null})}else r=n.c(_y.ek);if(i.a()==="TouchNarrow"){var y=this;n.b(_am.i,function(){return new _am.i(n.f(_am.g).e(),n.a(_a.x),n.a(_j.o),n.a(_y.a),i.a()==="TouchNarrow"?n.a(_y.r):null)});var c=this;n.b(_am.g,function(){return new _am.g(n.a(_am.c),n.a(_am.h),r,n.f(_am.e),n.f(_am.i),n.a(_no.c),n.a(_am.n),n.a(_a.e),n.a(_a.br),n.a(_j.j),n.a(_j.o),n.a(_y.a),n.a(_g.h),n.a(_a.q),n.a(_at.w),n.a(_am.l),n.a(_a.S),i,i.a()==="TouchNarrow"?n.a(_y.r):null)}).b(_y.bQ).a()}else{var u=this;n.b(_am.b,function(){return new _am.b(n.a(_am.c),n.a(_am.h),r,n.f(_am.e),n.f(_am.k),n.f(_am.p),n.a(_no.c),n.a(_am.n),n.a(_a.e),n.a(_a.br),n.a(_j.j),n.a(_j.o),n.a(_y.a),n.a(_g.h),n.a(_a.q),n.a(_at.w),n.a(_am.l),i,n.a(_a.S))}).b(_y.bQ).a()}var f=this;n.b(_am.e,function(){return new _am.e(i.a(),n.a(_a.q),n.a(_j.o),n.a(_y.a),n.a(_a.e),i.a()==="TouchNarrow"?n.a(_y.r):null)});var e=this;n.b(_am.k,function(){return new _am.k(n.a(_j.o),n.a(_y.a))});var h=this;n.b(_am.p,function(){return new _am.p(n.a(_j.o),n.a(_y.a),n.a(_a.q),n.a(_am.l),n.a(_am.c))});var s=this;n.b(_am.D,function(){var u=n.a(_at.Q);var r=n.a(_g.a).n();var t=_at.z.b(i);return new _am.D(u,r,n.a(_am.I),t?n.a(_y.bB):null,n.a(_at.K))}).b(_y.hM);var o=this;n.b(_am.n,function(){return new _am.n}).a();AttachmentsFilePickerViewModelsComponent.a=n.a(_y.bQ)},a:function(){return null}};AttachmentsFilePickerViewModelsComponent.b=function(n){AttachmentsFilePickerViewModelsComponent.b.$$(this.$$gta["AttachmentsFilePickerViewModelsComponent.b"].T).initializeBase(this,[n])};AttachmentsFilePickerViewModelsComponent.b.$$=function(n){var u=AttachmentsFilePickerViewModelsComponent.__tc=AttachmentsFilePickerViewModelsComponent.__tc||{};var t="b"+"$"+n.getName().replace(/\./g,"_");if(!u[t]){var r=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];AttachmentsFilePickerViewModelsComponent.b.apply(this,t)};var h=_j.J;r.registerClass("AttachmentsFilePickerViewModelsComponent.__tc."+t,h,_j.cc.$$(n));var o={"AttachmentsFilePickerViewModelsComponent.b":{T:n},ctor:AttachmentsFilePickerViewModelsComponent.b};var c=h.prototype.$$gta;for(var l in c){var s={key:l,value:c[l]};o[s.key]=s.value}r.prototype.$$gta=o;var f=AttachmentsFilePickerViewModelsComponent.b.prototype;for(var e in f){var i={key:e,value:f[e]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return u[t]};AttachmentsFilePickerViewModelsComponent.b.prototype={d:function(){return!1},a:function(n){n&&n(this.e())},b:function(n){this.a(n)}};_am.E=function(){_am.E.initializeBase(this)};_am.E.prototype={b:!1,d:!1,c:function(){return this.b},a:function(n){if(this.b===n)return n;this.b=n;this.b&&(this.d=!0);return n},p:function(){return 600},q:function(){return 300},h:function(){return!0}};_am.e=function(n,t,i,r,u,f){this.T=Function.createDelegate(this,this.bm);this.U=Function.createDelegate(this,this.bn);this.B=Function.createDelegate(this,this.bo);this.V=Function.createDelegate(this,this.bC);this.S=Function.createDelegate(this,this.Y);_am.e.initializeBase(this);this.w=n;this.o=t;this.A=i;this.Q=r;this.e=u;this.p=f;this.bx(new _db.j);var e=this;this.P=new _j.g(function(){e.H();e.eS("AttachmentCanceled")},_a.a.c);this.w==="TouchNarrow"&&this.fk(this.Z())};_am.e.prototype={P:null,w:0,o:null,A:null,Q:null,e:null,a:null,r:null,q:null,t:null,z:null,G:null,j:!1,D:!1,C:!1,v:null,f:!1,b:null,J:null,h:null,s:null,K:!1,E:null,g:null,d:null,p:null,X:function(n){this.eM("AttachmentCanceled",n)},bp:function(n){this.eO("AttachmentCanceled",n)},bv:function(n){if(this.q!==n){this.q=n;this.eH("AttachCommand")}return n},W:function(n){if(this.t!==n){this.t=n;this.eL("InsertPictureInlineCommand","ShouldShowPersistAttachOrShareOptionCheckbox")}return n},bl:function(){return!this.h.b()&&!this.t},bj:function(){return!this.q.b&&!this.z.b},bk:function(){return!this.e.a().jT().Enabled},bB:function(n){if(this.z!==n){this.z=n;this.eH("ShareCommand")}return n},bg:function(){return!!this.e&&this.e.a().co().Enabled&&!this.K&&!this.h.b()},bf:function(){this.G||(this.G=new _j.g(this.S,_a.a.c));return this.G},i:null,Y:function(){var t=new _at.br(this.o,"Mouse",this.e,this.M,null,null,!1);var n=new _at.T(t,this.e,this.o);n.w(!1,this.N,this.O,this.V,null)},bC:function(n){if(n){this.i=n;this.L(this.i.b)}},c:!1,bi:function(){return this.j?this.v?_ufp.A.l:this.e.a().bj().Enabled?this.c?_u.n.Qz:_u.n.NM:this.c?_u.n.En:_u.n.Bx:this.e.a().bj().Enabled?this.c?String.format(_ufp.A.Bn,this.d.A()):String.format(_ufp.A.BU,this.d.A()):this.c?String.format(_ufp.A.w,this.d.A()):String.format(_ufp.A.BI,this.d.A())},bh:function(){return this.e.a().bj().Enabled?this.c?_ufp.A.g:_ufp.A.Bb:this.c?_ufp.A.s:_ufp.A.BJ},bc:function(){return this.c?_u.n.Ko:_u.n.NO},bb:function(){return this.c?_ufp.A.Q:_ufp.A.Bm},bx:function(n){if(this.a!==n){this.a=n;this.eH("InfoBarViewModel")}return n},bu:function(n){if(this.j!==n){this.j=n;this.eH("AreLocalFiles")}return n},bs:function(n){if(this.D!==n){this.D=n;this.eH("AreGroupFiles")}return n},bq:function(n){if(this.C!==n){this.C=n;this.eH("AllowSettingAttachOrSharePreference")}return n},bz:function(n){if(this.v!==n){this.v=n;this.eH("ModernGroupDisplayName")}return n},R:function(n){if(this.f===n)return n;this.f=n;this.eH("PersistAttachOrShareOption");return n},bd:function(){this.E||(this.E=new _at.bd(!1));return this.E},be:function(){this.g||(this.g=new _am.E);return this.g},by:function(){return this.w==="Mouse"?!this.A.b()||this.A.m()||this.Q.b()?0:1:4},x:function(){return null},y:function(){return this.r},m:function(n){this.r=n;return n},bA:function(){return!0},L:function(n){if(this.J!==n){this.J=n;this.eH("EmailAttachmentsFolderName")}return n},O:null,N:null,M:null,H:function(){this.r&&this.r()},dx:function(){_y.lJ.prototype.dx.call(this);if(this.b){this.b.m=this.ba();_a.b.a(this.b);this.b=null;this.g&&(this.g.d=!1)}},n:function(){return this.w==="TouchNarrow"?1:0},bw:function(n){if(this.d===n)return n;this.d=n;this.eH("DataProviderInfo");return n},bD:function(n,t,i){this.s=n;this.h=t;var u=this.s||"PersonalOneDriveKey";var r=_at.n.e(u);if(_j.h.a(r)){this.L(_ufp.A.X);if(n&&(!i||!i.a(n,"AttachmentGetOneDriveUploadFolderName")))return;_j.h.a(this.s)||t.apcl("AttachmentDataProviders",this.B)}else this.L(r)},bo:function(n,t){if(this.h.a()&&this.h.a().x.length){var i=new _at.n(this.s);i.b(this.U);i.c(this.T);this.o.a(i)}},bn:function(n){var t=n.f;_j.h.a(t)&&(t=_ufp.A.X);this.L(t);this.h.rpcl("AttachmentDataProviders",this.B)},bm:function(n){this.h.rpcl("AttachmentDataProviders",this.B)},ba:function(){var n=new _a.l;n.a("W",this.K?1:0);n.a("P",this.g&&this.g.d?1:0);return n.toString()},Z:function(){var n=this.p.b();n.d(_ufp.A.S);if(this.A.a()){n.a(this.p.a(_y.b.b(),_y.b.b(),this.fj,""));n.e(3)}else n.a(this.p.a(_y.b.a(),_y.b.a(),this.fj,""));return n}};_am.t=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.t.initializeBase(this,[3,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.x(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.t.b=function(){return _fm.d.a("box_grey.png")};_am.t.a=function(){return _fm.d.a("box_dark.png")};_am.t.prototype={m:null,i:function(){return _am.t.b()},h:function(){return _am.t.a()},l:function(){return this.e()&&!this.a.b().bH.AttachmentsFilePickerHideAddBox},e:function(){return this.j.a().fH().Enabled&&!this.t(this.c)&&this.a.g().BoxAttachmentsEnabled&&this.a.g().ThirdPartyAttachmentsEnabled},d:function(n,t,i,r){var u=t.state;if(this.m===u){this.m=null;_am.f.prototype.d.call(this,n,t,i,r)}else this.f()},s:function(){return this.E()},o:function(n){this.a.b().bf(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eL("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var i="https://app.box.com/api/oauth2/authorize";var n=this.p;if(_j.h.a(n)){this.r();this.f();return}this.m=this.w();var t={state:this.m};this.q(i,n,"code",t)}};_am.l=function(n,t,i,r,u,f){this.R=Function.createDelegate(this,this.W);this.S=Function.createDelegate(this,this.X);this.Q=Function.createDelegate(this,this.V);_am.l.initializeBase(this);this.y=n;this.H=t;this.k=i;this.L=r;this.D=u;this.C=f;this.i(new _am.L(n,t,i,r,u,f));i&&i.a().fH().Enabled&&this.i(new _am.t(n,t,i,r,u,f));i&&i.a().fL().Enabled&&this.i(new _am.w(n,t,i,r,u,f));i&&i.a().fN().Enabled&&this.i(new _am.y(n,t,i,r,u,f));i&&i.a().fM().Enabled&&this.i(new _am.x(n,t,i,r,u,f))};_am.l.prototype={y:null,H:null,k:null,L:null,D:null,C:null,O:null,P:!1,A:!1,Y:function(n){n.n.a();this.by("SelectedDataProviderCreator");return n},i:function(n){n.R(this.Q);_j.l.prototype.a.call(this,n)},M:function(n){this.bB("NewDataProviderCreated",n)},J:function(n){this.O=n;var t=this;this.o(function(t){var i=t;Object.getType(i)!==_gg.cS&&i.G(n)})},T:function(n){var t=null;var i=this;this.o(function(i){var r=i;r.c===n&&(t=r)});t||_j.e.c(_a.a.c,_j.h.c("{0} data provider creator does not exist",n));return t},U:function(){if(this.k&&this.k.a().dM().Enabled&&!this.P&&!this.A){this.A=!0;var n=new _ao.g;n.b(this.S);n.c(this.R);this.y.a(n)}},X:function(n){for(var i=n.e,t=0;t<i.length;t++){var r=null;switch(i[t].a()){case 7:r=new _am.A(i[t],this.y,this.H,this.k,this.L,this.D,this.C);break;case 8:r=new _am.B(i[t],this.y,this.H,this.k,this.L,this.D,this.C);break;default:_j.e.c(_a.a.c,String.format("This data provider creator is not supported Wopi data provider creator. Provider type = {0}",i[t].a()));continue}this.i(r);r.G(this.O)}this.P=!0;this.A=!1},W:function(n){_j.e.b(_a.a.c,"Failed to load Wopi data providers.");this.A=!1},V:function(n){this.bO("NewDataProviderCreated",n)}};_am.f=function(n,t,i,r,u,f,e){this.K=Function.createDelegate(this,this.W);this.L=Function.createDelegate(this,this.X);this.M=Function.createDelegate(this,this.Y);_am.f.initializeBase(this);this.c=n;this.g=t;this.C=i;this.j=r;this.a=u;this.A=f;this.b=e;this.v=_at.w.a(r,this.c);this.H=new _j.g(this.M,_a.a.c)};_am.f.prototype={n:null,H:null,g:null,j:null,a:null,A:null,b:null,p:null,y:null,x:null,C:null,v:null,U:function(){return this.v.A()},D:function(){return _j.h.c(_ufp.A.BA,this.v.A())},O:function(){return"code"},c:0,R:function(n){this.eM("OnDataProviderCreated",n)},u:function(n){if(this.n!==n){this.n=n;this.eH("AddDataProviderCommand")}return n},G:function(n){this.x=n;this.r()},d:function(n,t,i,r){if(!n){this.f();_j.e.c(_a.a.c,_j.h.c("{0} oAuth code not returned in the redirect page.",_g.q.toString(this.c)));return}var f=this.N(_g.q.toString(this.c),"AttachmentsAddDataProvider");var u=new _ao.a(this.c,n,this.y);var o=this;u.b(function(n){o.T(n,i,r);o.B(f)});var e=this;u.c(function(n){e.S(n);f.n="FailedAddingProvider";e.B(f)});this.g.a(u)},r:function(){var n=new _ao.d(this.c);n.b(this.L);n.c(this.K);this.g.a(n)},V:function(){return window.location.host==="exchangelabs.live-int.com"?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa"},s:function(){return _j.h.c("{0}//{1}{2}ADPOAuthRedirect.html?provider={3}",window.location.protocol,window.location.host,window.location.pathname,_g.q.toString(this.c))},E:function(){var t=_j.h.c("{0}//{1}{2}ADPOAuthRedirect.html",window.location.protocol,window.location.host,window.location.pathname);var n=encodeURIComponent(_j.h.c("provider={0}&url={1}",_g.q.toString(this.c),t));return _j.h.c("{0}/ADPRedirect.aspx?{1}",this.V(),n)},q:function(n,t,i,r){this.y=this.s();var u=n;u=_a.v.a(u,"client_id",t);u=_a.v.a(u,"redirect_uri",this.y);u=_a.v.a(u,"response_type",i);if(r)for(var o=Object.keys(r),h=o.length,f=0;f<h;++f){var e=o[f];u=_a.v.a(u,e,r[e])}var s=this.N(_g.q.toString(this.c),"AttachmentsAddDataProviderAuthWindowOpened");this.B(s);_a.Z.a(u,600,600,!0)},f:function(){var n=this.v.A();this.Z(_ufp.A.O,_j.h.c(_ufp.A.BL,n))},Z:function(n,t){this.C.a(_a.u,new _a.u([t],0,null,0,!1,null,null,n,this.x,null,null,null))},t:function(n){if(this.b&&this.b.e)for(var t=0;t<this.b.e.x.length;t++)if(this.b.e.x[t].a.a()===n)return!0;return!1},w:function(){for(var i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),r=i.length-1,n=new Sys.StringBuilder("owa_csrf_token_"),t=0;t<16;t++)n.append(i[Math.round(Math.random()*r)]);return n.toString()},T:function(n,t,i){var u=n;var r=this.A.a(u.f,i);t(r);this.eT("OnDataProviderCreated",r);this.eL("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},S:function(n){_ao.d.isInstanceOfType(n)?_j.e.b(_a.a.c,"GetNewAttachmentDataProviderCreationInfoAction failed"):_ao.a.isInstanceOfType(n)&&_j.e.b(_a.a.c,"AddNewAttachmentDataProviderAction failed");this.f()},Y:function(){this.o(!0)||_j.e.c(_a.a.c,_j.h.c("Failed to persist the configuration for removing '{0}' placeholder",this.D()));this.eL("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},X:function(n){var t=n;t.e===this.c&&(this.p=t.f.ProviderAppKey)},W:function(n){_j.e.b(_a.a.c,"GetNewAttachmentDataProviderCreationInfoAction failed")},N:function(n,t){var r=_a.b.b(_a.a.c,t,!1,null);var i=new _a.l;i.b("DP",n);r.m=i.toString();return r},B:function(n){_a.b.a(n)}};_am.w=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.w.initializeBase(this,[2,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.x(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.w.b=function(){return _fm.d.a("dropbox_grey.png")};_am.w.a=function(){return _fm.d.a("dropbox_dark.png")};_am.w.prototype={m:null,i:function(){return _am.w.b()},h:function(){return _am.w.a()},l:function(){return this.e()&&!this.a.b().bH.AttachmentsFilePickerHideAddDropbox},e:function(){return this.j.a().fL().Enabled&&!this.t(this.c)&&this.a.g().DropboxAttachmentsEnabled&&this.a.g().ThirdPartyAttachmentsEnabled},d:function(n,t,i,r){var u=t.state;if(this.m===u){this.m=null;_am.f.prototype.d.call(this,n,t,i,r)}else this.f()},o:function(n){this.a.b().bg(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eL("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var i="https://www.dropbox.com/1/oauth2/authorize";var n=this.p;if(_j.h.a(n)){this.r();this.f();return}this.m=this.w();var t={state:this.m};this.q(i,n,"code",t)}};_am.x=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.x.initializeBase(this,[6,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.x(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.x.b=function(){return _fm.d.a("facebook_grey.png")};_am.x.a=function(){return _fm.d.a("facebook_dark.png")};_am.x.prototype={m:null,O:function(){return"access_token"},i:function(){return _am.x.b()},h:function(){return _am.x.a()},l:function(){return this.e()&&!this.a.b().bH.AttachmentsFilePickerHideAddFacebook},e:function(){return this.j.a().fM().Enabled&&this.a.g().ThirdPartyAttachmentsEnabled&&!this.t(this.c)},d:function(n,t,i,r){var u=t.state;if(this.m===u){this.m=null;_am.f.prototype.d.call(this,n,t,i,r)}else this.f()},s:function(){var t=encodeURIComponent(_j.h.c("provider={0}",_g.q.toString(this.c)));var n=_j.h.c("{0}//{1}",window.location.protocol,window.location.host);return _j.h.c("{0}/FBOAuthRedirect.html?{1}",n,t)},o:function(n){this.a.b().bh(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eL("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var t=this.p;if(_j.h.a(t)){this.r();this.f();return}this.m=this.w();var n={state:this.m};n.scope=String.format("{0},{1}","user_photos","email");this.q("https://www.facebook.com/dialog/oauth",t,"token",n)}};_am.y=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.y.initializeBase(this,[5,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.x(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.y.b=function(){return _fm.d.a("gdrive_grey.png")};_am.y.a=function(){return _fm.d.a("gdrive_dark.png")};_am.y.prototype={m:null,i:function(){return _am.y.b()},h:function(){return _am.y.a()},l:function(){return this.e()&&!this.a.b().bH.AttachmentsFilePickerHideAddGDrive},e:function(){return this.j.a().fN().Enabled&&this.a.g().ThirdPartyAttachmentsEnabled&&!this.t(this.c)},d:function(n,t,i,r){var u=t.state;if(!_j.h.a(u)){var e=JsonParser.deserialize(u);var f=e.state;if(this.m===f){this.m=null;_am.f.prototype.d.call(this,n,t,i,r);return}}this.f()},s:function(){var n=window.location.host==="exchangelabs.live-int.com"?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";return _j.h.c("{0}/ADPRedirect.aspx",n)},o:function(n){this.a.b().bi(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eL("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var r="https://accounts.google.com/o/oauth2/auth";var n=this.p;if(_j.h.a(n)){this.r();this.f();return}this.m=this.w();var u=_j.h.c("{0}//{1}{2}ADPOAuthRedirect.html",window.location.protocol,window.location.host,window.location.pathname);var t={state:this.m,provider:_g.q.toString(this.c),url:u};var i={state:JsonParser.serialize(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent"};this.q(r,n,"code",i)}};_am.L=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.L.initializeBase(this,[1,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.x(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.L.prototype={m:null,i:function(){return _fm.a.Z},h:function(){return _fm.a.Z},l:function(){return this.e()&&!this.a.b().bH.AttachmentsFilePickerHideAddOneDriveConsumer},e:function(){var t=this.j.a().kq().Enabled&&!this.j.a().b().Enabled;var n=this.b.u;return(t||n)&&this.a.g().OnedriveAttachmentsEnabled&&this.a.g().ThirdPartyAttachmentsEnabled&&!this.t(this.c)},d:function(n,t,i,r){var u=t.state;if(this.m===u){this.m=null;_am.f.prototype.d.call(this,n,t,i,r)}else this.f()},s:function(){return this.E()},o:function(n){this.a.b().bj(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eL("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var i="https://login.live.com/oauth20_authorize.srf";var n=this.p;if(_j.h.a(n)){this.r();this.f();return}this.m=this.w();var t={scope:"wl.basic onedrive.readwrite wl.offline_access",state:this.m};this.q(i,n,"code",t)}};_am.A=function(n,t,i,r,u,f,e){_am.A.initializeBase(this,[n,t,i,r,u,f,e])};_am.A.b=function(){return _fm.d.a("box_grey.png")};_am.A.a=function(){return _fm.d.a("box_dark.png")};_am.A.prototype={i:function(){return _am.A.b()},h:function(){return _am.A.a()}};_am.B=function(n,t,i,r,u,f,e){_am.B.initializeBase(this,[n,t,i,r,u,f,e])};_am.B.b=function(){return _fm.d.a("egnyte_grey.png")};_am.B.a=function(){return _fm.d.a("egnyte_dark.png")};_am.B.prototype={i:function(){return _am.B.b()},h:function(){return _am.B.a()}};_am.R=function(n,t,i,r,u,f,e){this.P=Function.createDelegate(this,this.bc);this.Q=Function.createDelegate(this,this.bd);this.J=Function.createDelegate(this,this.ba);_am.R.initializeBase(this,[n.a(),t,i,r,u,f,e]);this.m=n;this.u(new _j.g(this.J,_a.a.c));var h=this;this.b.apcl("AttachmentDataProviders",function(){h.z()});var s=this;this.b.x(function(){s.z()});var o=this;this.b.n(function(){o.z()})};_am.R.prototype={m:null,i:function(){return null},h:function(){return null},l:function(){return!1},e:function(){return this.j.a().dM().Enabled&&this.a.g().ThirdPartyAttachmentsEnabled&&this.bb()&&!this.t(this.c)},bb:function(){return!!this.m&&!!this.m.bH.AuthorizationUri},d:function(n,t,i,r){_am.f.prototype.d.call(this,n,t,i,r)},G:function(n){this.x=n;if(!this.m.bH.AuthorizationUri){var t=new _ao.h(this.c);t.b(this.Q);t.c(this.P);this.g.a(t)}},s:function(){return this.E()},o:function(n){return!1},z:function(){this.eL("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},ba:function(){this.q(this.m.bH.AuthorizationUri,this.m.bH.ProviderAppKey,"code",null)},bd:function(n){this.m=n.e},bc:function(n){_j.e.b(_a.a.c,"Failed to get data provider creator with provider type:{0}.",this.c)}};_am.o=function(n){this.l=Function.createDelegate(this,this.S);this.b=_am.a.c;this.h=_am.a.b;_am.o.initializeBase(this);this.a=n;var i=n.d;if(i){var t=i.r();this.b=t.SortOrder;this.h=t.SortColumn}this.a.apcl("IsSortingSupported",this.l)};_am.o.a=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_am.o.b=function(){return _fm.b.a(_fm.a.I,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_am.o.c=function(){return _fm.b.a(_fm.a.w,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_am.o.d=function(){return _fm.b.a(_fm.a.w,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_am.o.prototype={a:null,d:0,f:0,c:0,g:0,e:0,B:function(){return this.j(0,this.b)},y:function(){return this.j(2,this.d)},J:function(){return this.j(1,this.f)},v:function(){return this.j(3,this.c)},M:function(){return this.j(4,this.g)},E:function(){return this.j(5,this.e)},A:function(){return this.i(0,this.b)},x:function(){return this.i(2,this.d)},H:function(){return this.i(1,this.f)},u:function(){return this.i(3,this.c)},L:function(){return this.i(4,this.g)},D:function(){return this.i(5,this.e)},C:function(){return this.a.i?this.b?_ufp.A.J:_ufp.A.Bl:null},z:function(){return this.a.i?this.d?_ufp.A.M:_ufp.A.K:null},K:function(){return this.a.i?this.f?_ufp.A.q:_ufp.A.n:null},w:function(){return this.a.i?this.c?_ufp.A.J:_ufp.A.Bl:null},N:function(){return this.a.i?this.g?_ufp.A.J:_ufp.A.Bl:null},G:function(){return this.a.i?this.e?_ufp.A.M:_ufp.A.K:null},p:function(n){if(this.b!==n){this.b=n;this.eV("NameHeaderImageId","NameHeaderHoveredImageId","NameHeaderToolTip")}return n},o:function(n){if(this.d!==n){this.d=n;this.eV("LastModifiedHeaderImageId","LastModifiedHeaderHoveredImageId","LastModifiedHeaderToolTip")}return n},r:function(n){if(this.f!==n){this.f=n;this.eV("SizeHeaderImageId","SizeHeaderHoveredImageId","SizeHeaderToolTip")}return n},n:function(n){if(this.c!==n){this.c=n;this.eV("FromHeaderImageId","FromHeaderHoveredImageId","FromHeaderToolTip")}return n},s:function(n){if(this.g!==n){this.g=n;this.eV("SubjectHeaderImageId","SubjectHeaderHoveredImageId","SubjectHeaderToolTip")}return n},q:function(n){if(this.e!==n){this.e=n;this.eV("ReceivedDateHeaderImageId","ReceivedDateHeaderHoveredImageId","ReceivedDateHeaderToolTip")}return n},O:function(n){if(this.h!==n){this.h=n;this.m()}return n},R:function(n){return this.h===n?this.Q(n):0},t:function(n,t){this.O(n);this.P(n,t)},P:function(n,t){switch(n){case 0:this.p(t);break;case 1:this.r(t);break;case 2:this.o(t);break;case 3:this.n(t);break;case 4:this.s(t);break;case 5:this.q(t);break;default:break}},Q:function(n){var t=0;switch(n){case 0:this.p(this.k(this.b));t=this.b;break;case 1:this.r(this.k(this.f));t=this.f;break;case 2:this.o(this.k(this.d));t=this.d;break;case 3:this.n(this.k(this.c));t=this.c;break;case 4:this.s(this.k(this.g));t=this.g;break;case 5:this.q(this.k(this.e));t=this.e;break;default:break}return t},k:function(n){switch(n){case 0:n=1;break;case 1:n=0;break;default:break}return n},j:function(n,t){return this.a.i&&this.h===n?t?_am.o.a():_am.o.c():null},i:function(n,t){return this.a.i&&this.h===n?t?_am.o.b():_am.o.d():null},S:function(n,t){this.m()},m:function(){this.eP(["NameHeaderImageId","NameHeaderHoveredImageId","NameHeaderToolTip","LastModifiedHeaderImageId","LastModifiedHeaderHoveredImageId","LastModifiedHeaderToolTip","SizeHeaderImageId","SizeHeaderHoveredImageId","SizeHeaderToolTip","FromHeaderImageId","FromHeaderHoveredImageId","FromHeaderToolTip","SubjectHeaderImageId","SubjectHeaderHoveredImageId","SubjectHeaderToolTip","ReceivedDateHeaderImageId","ReceivedDateHeaderHoveredImageId","ReceivedDateHeaderToolTip"])}};_am.c=function(n,t,i,r,u,f,e,o){this.bW=Function.createDelegate(this,this.cy);this.by=Function.createDelegate(this,this.cw);this.bV=Function.createDelegate(this,this.cx);this.Z=Function.createDelegate(this,this.cG);this.bB=Function.createDelegate(this,this.ch);this.bC=Function.createDelegate(this,this.cI);this.bz=Function.createDelegate(this,this.cD);this.ca=Function.createDelegate(this,this.cH);this.cc=Function.createDelegate(this,this.cK);this.bX=Function.createDelegate(this,this.cC);this.cb=Function.createDelegate(this,this.cJ);this.bY=Function.createDelegate(this,this.cE);this.bZ=Function.createDelegate(this,this.cF);this.bA=Function.createDelegate(this,this.cg);this.v=_a.H.a();_am.c.initializeBase(this);this.bc=n;this.j=new _j.l;this.bN=t;this.P=i;this.bR(new _j.l);this.bI=u;this.bH=f;this.cd=e;this.bS=o;this.i=!1;this.H=!1;this.Y=!1;this.V=!1;this.X=!1;this.W=!0;this.M=new _j.g(this.bZ,_a.a.c);this.L=new _j.g(this.bY,_a.a.c);this.N=new _j.g(this.cb,_a.a.c);this.bd=new _j.g(this.bX,_a.a.c);this.bf=new _j.g(this.cc,_a.a.c);this.be=new _j.g(this.ca,_a.a.c);this.M.c(!1);this.L.c(!1);this.N.c(!1);this.A=r;i&&i.a()&&i.a().H()&&i.a().H().Enabled&&(_am.c.c=i.a().H().MCBingInlineImagePickerBaseEndpoint||"https://insertmedia.bing.office.net")};_am.c.prototype={e:null,bm:null,bo:null,d:null,h:null,j:null,p:null,bI:null,bc:null,A:null,bH:null,g:null,D:!1,S:!1,bl:!1,m:null,o:null,l:null,Q:null,bw:!1,bh:null,E:!1,bi:null,t:null,bN:0,R:!1,f:null,M:null,L:null,N:null,bd:null,bf:null,be:null,r:null,i:!1,W:!1,H:!1,Y:!1,V:!1,X:!1,bv:!1,bk:!1,bD:!1,bS:!1,bg:null,bn:null,bO:null,y:0,P:null,bG:null,cd:null,z:null,s:null,u:!1,bQ:function(n){this.y!==n&&(this.y=n);return n},ba:null,J:!1,a:function(){return this.e},cS:function(n){if(this.e!==n){this.e=n;this.eH("AttachmentDataProviders");this.bU(n)}return n},cW:function(n){if(this.bm!==n){this.bm=n;this.eH("PrimaryDataProviders")}return n},cX:function(n){if(this.bo!==n){this.bo=n;this.eH("SecondaryDataProviders")}return n},br:function(n){if(this.h!==n){this.h=n;this.dh();this.cV(this.cr());this.cT(new _am.o(this));this.eH("CurrentFolder")}return n},cT:function(n){if(this.r!==n){this.r&&this.r.dispose();this.r=n;this.eH("CurrentFolderSortInfo")}return n},bs:function(n){if(this.D!==n){this.D=n;this.eH("IsDataInProgress");this.bT();this.ck(n)}return n},ck:function(n){if(this.bl&&this.S!==n){this.S=n;this.eH("IsSearchingInProgress")}return n},bu:function(n){if(this.g===n)return n;if(this.g){this.g.bo(this.bz);this.g.fg(this.bg)}this.g=n;if(this.g){var i=this.d;var t=this;this.bg=function(n,r){t.cv(i)};this.g.be(this.bz);this.g.eY(this.bg);this.g.d()?this.bs(!0):this.bE()}this.eH("ItemsTable");return n},U:function(n){if(this.d!==n){var t=this.d;this.d=n;if(this.d){this.bQ(this.d.br());this.d.bc(!0);this.d.d||this.d.x(this.d.T());this.d.apcl("AttachmentItemsFilterBy",this.bC)}if(t){t.bc(!1);t.x(null);t.rpcl("AttachmentItemsFilterBy",this.bC)}this.bT();this.bx();this.eH("SelectedDataProvider")}return n},bR:function(n){if(this.f!==n){this.f&&this.f.f(this.bB);this.f=n;this.f&&this.f.e(this.bB);this.ch(null,null);this.eH("SelectedAttachmentDataProviderItems")}return n},bp:function(n){if(this.s!==n){this.s=n;this.eH("SelectedAttachmentsChanged")}return n},T:function(n){if(this.Q!==n){this.Q=n;this.eH("InfoMessage")}return n},cm:function(n){if(this.bw!==n){this.bw=n;this.eH("ShowEmptySearchResultMessage")}return n},bq:function(n){if(this.p!==n){var t=this.p;this.p=n;if(this.p&&this.p!==_am.c.b&&(this.h!==n||t===_am.c.b)){this.w();this.B(this.p,!0,this.d?this.d.r():null)}this.eH("BreadCrumbsSelectedItem")}return n},cV:function(n){if(this.E===n)return n;this.E=n;this.eH("IsOneDriveProGroupsView");return n},bb:!1,bt:function(n){if(this.i!==n){this.i=n;this.dj();this.eH("IsSortingSupported")}return n},cZ:function(n){if(this.W!==n){this.W=n;this.eH("ShouldShowModifiedHeader")}return n},cl:function(n){if(this.H!==n){this.H=n;this.eH("ShouldShowClickableSizeHeader")}return n},dc:function(n){if(this.Y!==n){this.Y=n;this.eH("ShouldShowUnclickableSizeHeader")}return n},cY:function(n){if(this.V!==n){this.V=n;this.eH("ShouldShowFromHeader")}return n},db:function(n){if(this.X!==n){this.X=n;this.eH("ShouldShowSubjectHeader")}return n},da:function(n){if(this.bv!==n){this.bv=n;this.eH("ShouldShowReceivedDateHeader")}return n},ct:function(){if(!this.bh){var t=this,n=this;this.bh=new _y.bt(new _am.P,function(n){return _gg.j.isInstanceOfType(n)?n.bH.GroupCategory:""},function(n){return n},"")}return this.bh},bJ:function(){return this.bN==="Mouse"?this.A.a().K():this.A.a().L()},K:function(n){this.eM("OnDataProvidersLoadedEvent",n)},bP:function(n){this.eO("OnDataProvidersLoadedEvent",n)},cU:function(n){this.bk=n;this.eH("IsAnyFolderSelected");return n},cu:function(){var n=this.bK();return n?n.M():!1},b:function(){return this.u},x:function(n){this.eM("DataProviderAddedToDPFilesViewModel",n)},n:function(n){this.eM("DataProviderRemovedFromDPFilesViewModel",n)},cj:function(n){this.eO("DataProviderRemovedFromDPFilesViewModel",n)},dg:function(){if(this.s){this.z=this.s;this.bp(null)}},cQ:function(){if(this.z){this.bp(this.z);this.z=null}},bF:function(){this.bp(null);this.z=null},cp:function(n){n.E(this.Z);this.e.a(n);this.bU(this.e);this.eT("DataProviderAddedToDPFilesViewModel",n)},cP:function(n){n.Y(this.Z);this.e.p(n,!0);this.bU(this.e);this.eT("DataProviderRemovedFromDPFilesViewModel",n)},C:function(n){this.bO=n;if(this.e){var t=this;this.e.o(function(i){var r=i;r.f()&&r.bl(n,function(n){t.cP(n)})})}},c:function(){this.l=_a.b.b(_a.a.c,"AttachmentsFilePickerGetDataProviders",!1,null);this.q();var n=new _at.B(2);n.b(this.bV);n.c(this.by);this.bc.a(n)},cO:function(){if(!this.e){_j.e.b(_a.a.c,"Failed to ReloadFirstPrimaryDataProvider since AttachmentDataProviders is still null");return}this.q();for(var n,t=0;t<this.e.x.length;t++){n=this.e.x[t];if(n.a.a()===1||!n.a.a()){this.d===n?this.bM(n,null):this.U(n);break}}},B:function(n,t,i,r){this.bj(n,t,t,r,!1,i,null)},cR:function(n){this.w("AttachmentsFilePickerSearchItems");this.bj(this.h,!1,!0,null,!1,this.d?this.d.r():null,n)},dd:function(n){if(n){this.bt(!1);this.bq(_am.c.b)}else{this.bx();this.bq(this.h);this.ck(!1)}this.bl=n},G:function(n){if(!this.h){_j.e.b(_a.a.c,"CurrentFolder is null when ReExpandCurrentFolderWithSortColumn");return}for(var i=0;i<this.f.x.length;i++){var r=this.f.x[i];this.v.a(r.bH.Id,!0)}var t=new _gg.D;t.SortColumn=n;t.SortOrder=this.r.R(n);this.bj(this.h,!0,!0,null,!0,t,null);this.cs(n,t.SortOrder)},ci:function(){this.q();this.bj(this.h,!1,!0,null,!0,this.bG,null)},cs:function(n,t){var r=_a.b.b(_a.a.c,"AttachmentsFilePickerSort",!1,null);var i=new _a.l;i.a("C",n);i.a("O",t);r.m=i.toString();_a.b.a(r)},bj:function(n,t,i,r,u,f,e){if(n===this.t){this.cn();return}if(f)this.r&&this.r.t(f.SortColumn,f.SortOrder);else{f=new _gg.D;f.SortColumn=_am.a.b;f.SortOrder=_am.a.c}if(t){this.q();this.br(n);this.bG=f}var c=new _at.bl(n,n.e,f,n.d,e,n.c,r,u,this.y);var h=this;var o=_h.c.b(c,_h.g.a(),function(n){return new _at.bQ(n,h.P,!1)});i&&this.bu(o);var s=50;o.bx&&o.bx.x.length>0&&(s=o.bx.x.length);o.k(new _h.n(0,s),null,null);i&&this.bT()},cn:function(){this.br(this.t);this.bu(this.bi);this.bx();if(this.g){this.w("AttachmentsFilePickerGetGroups");this.g.O();this.bs(!0)}},cN:function(){if(this.g){this.w("AttachmentsFilePickerGetRecentItems");this.g.O();this.bs(!0)}},cL:function(){this.l=_a.b.b(_a.a.c,"AttachmentsFilePickerGetDataProvidersPreload",!1,null);var n=new _at.B(2);n.b(this.bW);n.c(this.by);this.bc.a(n)},de:function(n){if(!this.t||!this.bi){this.t=new _at.v("AttachmentsDataProvider_Groups","",_ufp.A.BS,null,null,n);this.t.a=!0;this.bi=new _ao.e(new(_h.dU.$$(_ao.e))(this.t))}},w:function(n){n||(n="AttachmentsFilePickerChangeFolder");if(this.m){var t=this.m;t.n="Abandoned";t.m=this.O();_a.b.a(this.m);this.m=null}this.m=_a.b.b(_a.a.c,n,!1,null)},df:function(){if(this.o){var n=this.o;n.n="Abandoned";n.m=this.cf();_a.b.a(this.o);this.o=null}this.o=_a.b.b(_a.a.c,"AttachmentsFilePickerChangeFilter",!1,null)},q:function(){this.f.g()},cg:function(n){this.U(n);this.q();this.bM(n,null);this.bx()},bM:function(n,t){if(n)if(t){var r=new _at.v("","",t.DisplayName,t,n.a.bH.EndPointUrl,n.a);r.a=!0;this.B(r,!1,n.r())}else{this.w("AttachmentsFilePickerLoadRootFolder");var u=n.c()?n.c().DisplayName:n.a.bH.DisplayName;var i=new _at.v("","",u,n.c(),n.a.bH.EndPointUrl,n.a);i.a=!0;this.B(i,!0,n.r())}},dh:function(){if(this.h){if(this.p!==this.h||!this.j.x.length||this.j.x[this.j.x.length-1]!==this.h){var n=this.j.m(this.h);if(n>=0&&n<this.j.x.length-1)this.j.r(n+1,this.j.x.length-(n+1));else if(this.h.a||this.d&&this.h.Id===this.d.a.bH.Id){this.j.g();this.j.a(this.h)}else this.j.a(this.h);this.bq(this.h)}}else this.j.g()},cB:function(n){return n.a.bH.IsThirdPartyProvider||_am.q.isInstanceOfType(n)},bU:function(n){var r=new _j.l;var t=new _j.l;var i=this;n.o(function(n){var u=n;i.cB(u)?t=i.cq(t,u):r.a(u)});this.cW(r);this.cX(t)},cq:function(n,t){for(var i=0;i<n.x.length;i++){var r=n.x[i];if(r.a.bH.DisplayName.localeCompare(t.a.bH.DisplayName)>0){n.t(i,t);return n}}n.a(t);return n},cD:function(n,t){this.bs(this.g.d());if(!this.D){if(this.m){this.m.m=this.O();_a.b.a(this.m);this.m=null;this.d&&this.d.g(this.g.bF)}if(this.o){this.o.m=this.cf();_a.b.a(this.o);this.o=null}if(this.v.f()>0){for(var u=new _j.l,f=this.g.bx.x.length,i=f-1;i>=0;i--){var r=this.g.bx.x[i];if(this.v.c(r.bH.Id)){u.a(r);this.v.e(r.bH.Id)}}this.bR(u);this.v.f()>0&&(this.v=_a.H.a())}}},cv:function(n){if(this.g.bT){var u,r;var t=this.g.bQ;switch(t.f){case 2:u=_ufp.A.H;r="AccessDenied";break;case 4:u=_ufp.A.B;r="NotFound";break;default:u=_ufp.A.C;r=_at.r.c(t);break}if(t.f===2&&n.f()){var f=this;this.bn=function(t){if(t===n){f.cj(f.bn);f.cM(n)}};this.n(this.bn);n.w.a()}this.T(u);if(this.m){var i=this.m;i.n=t.O();i.p=r;i.o=t.P();i.m=this.O();_a.b.a(i);this.m=null}}},co:function(n){var h=n;_am.c.a=h.e;if(_am.c.a.length<=0){if(!this.e||this.e.x.length<=0){this.T(this.bJ());this.J=!0}}else{this.J=!1;for(var o=new _j.l,s=new _at.bh,c=_am.c.a,l=c.length,e=0;e<l;++e){var i=c[e];var u=!1;if(this.e)for(var f=0;f<this.e.x.length;f++){var r=this.e.x[f];if(r.a.bH.Id===i.bH.Id){r.bs(i);o.a(r);u=!0;break}}var t=null;if(!u){t=this.bH.a(i,this.bA);if(t){t.E(this.Z);o.a(t)}}(t||u)&&s.b(i.a(),!0);t&&t.a.bH.Type===5&&!t.a.bH.IsThirdPartyProvider&&(this.u=!0)}this.cS(o);this.A.i(s);this.e.w(this.d)||this.U(null)}if(this.l){this.l.o=h.P();this.l.m=this.O();_a.b.a(this.l);this.l=null}this.bb=!0;this.eW("OnDataProvidersLoadedEvent",this,null)},cx:function(n){this.co(n)},cy:function(n){this.co(n);if(this.e&&this.bS)for(var t,r=0;r<this.e.x.length;r++){t=this.e.x[r];if(t.p()){for(var u=t.i(),i=0;i<u.d.length;i++)this.bM(t,u.d[i]);break}}},cw:function(n){this.U(null);this.T(this.bJ());if(this.l){this.l.n=n?n.O():null;this.l.o=n?n.P():null;this.l.m=this.O();_a.b.a(this.l);this.l=null}this.eW("OnDataProvidersLoadedEvent",this,null)},bT:function(){if(this.D){this.bE();return}this.g&&(this.g.bx&&this.g.bx.x.length?this.bE():this.bl?this.cm(!0):this.Q||this.T(_ufp.A.o))},bE:function(){this.cm(!1);this.T(null)},cr:function(){return this.h&&this.h.Id==="AttachmentsDataProvider_Groups"?!0:!!this.d&&!!this.d.c()&&this.d.c().__type===_gg.bU._dataContractName&&this.d.c().Type===3&&this.j.x.length===1},ce:function(){var n=new _a.l;n.a("W",this.R?1:0);this.d&&this.d.a&&n.b("DP",_g.q.toString(this.d.a.a()));return n},O:function(){var n=this.ce();return n.toString()},cf:function(){var n=this.ce();n.b("F",this.y.toString());return n.toString()},ch:function(n,t){var u=!1,f=!1;if(this.f)for(var i=0;i<this.f.x.length;i++){var r=this.f.x[i];this.bL(r)||(u=!0);(this.cz(r)||this.cA(r))&&(f=!0);if(u&&f)break}this.cU(u);this.bD=f;this.eH("SelectedAttachmentsChanged")},bL:function(n){return!n.a()||_gg.h.isInstanceOfType(n)},cA:function(n){return this.P&&this.P.a().bV().Enabled?this.bL(n)&&_j.h.a(_a.bc.a(n.bH.Name))&&n.bH.MimeType==="application/onenote":this.bL(n)&&_j.h.a(_a.bc.a(n.bH.Name))},cz:function(n){var r=this.bK();if(r){var i=r.S();if(i)for(var u=n.bH.MimeType.toLowerCase(),t=0;t<i.d.length;t++)if(i.d[t].toLowerCase()===u)return!0}return!1},bx:function(){if(this.h&&this.h.Id==="AttachmentsDataProvider_Groups")this.cl(!0);else if(this.d){this.cl(this.d.l());this.dc(this.d.U())}_j.e.a(_a.a.c,"ShouldShowClickableSizeHeader = {0}",this.H);this.h&&this.h.Id==="AttachmentsDataProvider_Groups"?this.bt(!1):this.d?this.bt(this.d.j()):this.bt(!1);_j.e.a(_a.a.c,"IsSortingSupported = {0}",this.i);this.d&&this.di()},di:function(){var n=this.bK();if(n){this.cY(n.N());this.db(n.Q());this.da(n.P());this.cZ(n.O())}},dj:function(){_j.e.a(_a.a.c,"UpdateSortingCommands with IsSortingSupported={0}",this.i);this.M.c(this.i);this.N.c(this.i);this.L.c(this.i);this.bd.c(this.i);this.bf.c(this.i);this.be.c(this.i)},cM:function(n){if(this.ba){var u=n.a.a();var t=this.ba.T(u);if(t&&t.l()){var r=n.t.A();var f=this;var i=function(n,i){n&&t.n.a()};this.bI.a(_a.u,new _a.u([_j.h.c(_ufp.A.BF,r)],0,i,1,!1,null,null,_ufp.A.D,this.bO,null,null,null))}}},cF:function(){this.G(0)},cE:function(){this.G(2)},cJ:function(){this.G(1)},cC:function(){this.G(3)},cK:function(){this.G(4)},cH:function(){this.G(5)},cG:function(n){this.cg(n)},bK:function(){return this.d?this.A.c(this.d.a.a()):null},cI:function(n,t){this.df();this.bQ(this.d.u);this.ci()}};_am.h=function(n,t){this.i=Function.createDelegate(this,this.d);this.p=Function.createDelegate(this,this.l);_am.h.initializeBase(this);this.q=n;this.n(_ufp.A.Bc);this.y(new _j.g(this.p,_am.h.a));this.z(new _j.g(this.i,_am.h.a));this.x(new _j.g(this.i,_am.h.a))};_am.h.prototype={e:0,q:null,b:!1,c:!1,m:null,a:null,f:null,j:null,k:null,g:null,h:null,A:function(n){if(this.b!==n){this.b=n;this.v();this.eH("IsSearchEnabled")}return n},B:function(n){if(this.c!==n){this.c=n;this.w();this.eL("IsSearchTextBoxInFocus","DoesUserIntendToSearch")}return n},r:function(){return this.c||!_j.h.a(this.a)},n:function(n){if(this.h!==n){this.h=n;this.eH("Placeholder")}return n},y:function(n){if(this.f!==n){this.f=n;this.eH("EnterCommand")}return n},x:function(n){this.j=n;this.eH("CancelCommand");return n},u:function(){return this.k},z:function(n){this.k=n;this.eH("EscapeCommand");return n},o:function(n){if(this.e!==n){this.e=n;this.eH("State")}return n},s:function(n){if(this.a!==n){this.a=n;this.eL("QueryString","DoesUserIntendToSearch")}return n},d:function(){this.s("");this.l()},C:function(n){if(this.b){this.n(_j.h.b(n)?_ufp.A.Bc:_j.h.c(_ufp.A.BZ,n));return!0}return!1},l:function(){if(this.b&&this.m!==this.a){this.m=this.a;this.t(this.a);this.o(_j.h.a(this.a)?0:1)}},w:function(){!this.c&&_j.h.a(this.a)&&this.l()},v:function(){this.b||this.o(0)},t:function(n){this.g&&this.g(n)}};_am.s=function(n){_am.s.initializeBase(this);this.a=n;this.a.U()};_am.s.prototype={a:null};_am.p=function(n,t,i,r,u){this.p=Function.createDelegate(this,this.v);this.o=Function.createDelegate(this,this.s);this.j=Function.createDelegate(this,this.r);_am.p.initializeBase(this);this.f=n;this.i=t;this.q=i;this.g=new _j.g(this.j,_a.a.c);this.b=new _j.l;this.a=u;this.d=r;r.J(null);this.h=new _am.s(this.d);this.t()};_am.p.prototype={g:null,f:null,i:null,q:null,h:null,a:null,b:null,d:null,e:null,by:function(){return!this.f.b()||this.f.m()||this.i.b()?0:1},x:function(){return null},c:null,y:function(){return this.c},m:function(n){this.c=n;return n},bA:function(){return!0},w:function(n){if(this.e!==n){this.e=n;this.eH("PrimaryDataProvider")}return n},r:function(){this.c&&this.c()},t:function(){this.a.K(this.o);var n=this;this.d.M(function(t){n.s()});this.a.n(this.p);this.a.c()},s:function(){this.b.g();this.a.C(null);this.a.e.x.length||_j.e.b(_a.a.d,"AttachmentDataProviders has no elements.");for(var n=0;n<this.a.e.x.length;n++){var t=this.a.e.x[n];n?t.a.a()!==4&&this.b.a(t):this.w(t)}},v:function(n){this.b.p(n,!0)}};_am.j=function(){_am.j.initializeBase(this);this.a=dataProviderModel;this.set_dataProviderPivots(this.createDataProviderPivots());this.selectedPivotChangedHandler=selectedPivotChangedHandler};_am.j.prototype={a:null};_am.m=function(n,t){this.a=n;this.b=t};_am.m.prototype={a:null,b:0};_am.u=function(n,t,i,r,u,f){_am.u.initializeBase(this,[n,t,i,r,u,f])};_am.u.a=function(){return _fm.d.a("box.png")};_am.u.prototype={e:function(){return _am.u.a()},n:function(){return!0},f:function(){return!0},o:function(){return!1},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"Files"}};_am.r=function(){};_am.r.prototype={b:0,c:0,a:!1};_am.a=function(n,t,i,r,u,f){this.M=Function.createDelegate(this,this.bm);this.N=Function.createDelegate(this,this.bn);this.O=Function.createDelegate(this,this.bq);_am.a.initializeBase(this);this.a=n;this.D=i;this.R=u;this.bb(this.y());t&&this.P(t);this.t=_at.w.a(u,this.a.a());this.G=r;this.J=!!u&&u.a().N().Enabled&&!!f&&f.d().b("15.01.0484.000");this.w=new _j.g(this.O,_a.a.c);this.L=new _j.g(this.N,_a.a.c);this.u=0;this.v=1;this.J&&this.bw()};_am.a.prototype={q:null,z:!1,a:null,d:null,b:null,w:null,L:null,A:null,G:null,D:null,R:null,B:null,J:!1,s:null,v:0,u:0,S:function(){return 0},bj:function(){return!_am.a.a&&!!this.s},U:function(){return!1},o:function(){return!0},H:function(){this.q||(this.q=new _am.r);return this.q},r:function(){var n=new _gg.D;n.SortColumn=_am.a.b;n.SortOrder=_am.a.c;return n},f:function(){return!1},t:null,bc:function(n){if(this.z!==n){this.z=n;this.eH("IsSelected")}return n},bs:function(n){if(this.a!==n){this.a=n;this.bb(this.y());this.d&&this.x(this.T());this.eH("DataProviderModel")}return n},bb:function(n){if(this.b===n)return n;this.b=n;this.eL("DataProviderPivots","DataProviderPivotsArray");return n},bh:function(){return this.b.d()},x:function(n){if(this.d&&n&&this.d.b===n.b&&this.d.c===n.c)return n;this.d=n;this.d&&this.eW("SelectedPivotChangedHandler",this,null);this.eL("SelectedPivot","SelectedPivotIndex");return n},bi:function(){return!this.b||!this.a?-1:!this.d&&this.a?this.W():this.b.m(this.d)},bu:function(n){this.x(this.b.x[n]);return n},T:function(){return this.b?this.bk():null},c:function(){return this.b?this.d.a:null},ba:function(n){if(this.u!==n){this.u=n;this.eH("AttachmentItemsFilterBy")}return n},bt:function(n){if(this.s!==n){this.s=n;this.eL("ShouldShowItemsFilterByContextMenu","ItemsFilterByContextMenu")}return n},P:function(n){this.eM("SelectedPivotChangedHandler",n)},bo:function(n){this.eO("SelectedPivotChangedHandler",n)},E:function(n){this.eM("PivotClickHandler",n)},Y:function(n){this.eO("PivotClickHandler",n)},K:function(){return this.a.bH.IsSearchSupported},bl:function(n,t){this.B=n;this.A=t},br:function(){_am.a.a?this.ba(1):this.bd(1,0,!0);return this.u},bp:function(n,t){var i=n;if(i.e&&this.A){this.Q(t);this.A(this)}else this.Z(t)},Z:function(n){n.n="RemoveProviderFailed";this.Q(n);this.bv()},X:function(){return null},m:function(n,t){var r=_a.b.b(_a.a.c,n,!1,null);var i=new _a.l;i.a("N",t);i.b("DP",this.V());r.m=i.toString();_a.b.a(r)},bg:function(n){var i=_a.b.b(_a.a.c,n,!1,null);var t=new _a.l;t.b("DP",this.V());i.m=t.toString();return i},Q:function(n){_a.b.a(n)},bv:function(){!this.B;var n=this.t.A();this.G.a(_a.u,new _a.u([_j.h.c(_ufp.A.P,n)],0,null,0,!1,null,null,_ufp.A.r,this.B,null,null,null))},bq:function(){var t=this.bg("AttachmentsRemoveDataProvider");var n=new _ao.k(this.a.bH.Id);var r=this;n.b(function(n){r.bp(n,t)});var i=this;n.c(function(n){i.Z(t)});this.D.a(n)},bn:function(){this.eW("PivotClickHandler",this,null)},V:function(){return this.a?_g.q.toString(this.a.a()):"Unknown"},y:function(){var t=this.a.b();if(!t||!t.b())return null;for(var i=new _j.l,n=0;n<t.b();n++){var u=_j.h.c("{0} {1}",this.a.bH.DisplayName,this.a.b().a(n).AriaLabel);var r=_j.h.c(_ufp.A.BR,u);i.a(new _ff.f(t.a(n).DisplayName,t.a(n),r))}return i},bk:function(){if(!this.a.a())for(var t=this.a.b().a(this.W()),n=0;n<this.b.x.length&&t;n++)if(this.b.x[n].b===t.DisplayName)return this.b.x[n];return this.b.x[this.a.bH.DefaultScopeIndex]},W:function(){if(!this.a.a())for(var n=0;n<this.a.b().b();n++)if(!this.a.b().a(n).Type)return n;return this.a.bH.DefaultScopeIndex},bw:function(){var t=this.X();if(t){var i=new _fm.e(new Array(0));i.p.a(new _fm.n(_ufp.A.Bd));for(var n=0;n<t.length;n++){var r=t[n].b;i.p.a(new _am.K(t[n].a,n+1,r,!n,this.M))}this.bt(i)}},bm:function(n,t){this.bd(n,t,!1)},bd:function(n,t,i){if(this.v!==n){var u=this.s.p.x[this.v];u.i(!1);this.v=n;if(i){var r=this.s.p.x[this.v];r.i(!0)}}this.ba(t)}};_am.v=function(n,t,i,r){this.c=n;this.e=t;this.b=i;this.d=r};_am.v.prototype={c:null,e:null,b:null,d:null,a:function(n,t){var i=n.a();switch(i){case 0:return new _am.N(n,t,this.c,this.e,this.b,this.d);case 1:return new _am.M(n,t,this.c,this.e,this.b,this.d);case 2:return new _am.F(n,t,this.c,this.e,this.b,this.d);case 3:return new _am.u(n,t,this.c,this.e,this.b,this.d);case 5:return new _am.H(n,t,this.c,this.e,this.b,this.d);case 4:return this.b.a().kJ().Enabled?new _am.q(n,t,this.c,this.e,this.b,this.d):null;case 6:return new _am.G(n,t,this.c,this.e,this.b,this.d);case 7:return new _am.O(n,t,this.c,this.e,this.b,this.d);case 8:return new _am.J(n,t,this.c,this.e,this.b,this.d)}_j.e.b(_am.v.a,String.format("This data provider is not a defined AttachmentDataProviderType in the client code. Provider type = {0}",i));return null}};_am.F=function(n,t,i,r,u,f){_am.F.initializeBase(this,[n,t,i,r,u,f])};_am.F.a=function(){return _fm.d.a("dropbox.png")};_am.F.prototype={e:function(){return _am.F.a()},n:function(){return!0},f:function(){return!0},o:function(){return!1},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"My files"}};_am.G=function(n,t,i,r,u,f){_am.G.initializeBase(this,[n,t,i,r,u,f]);var e;this.q=(e=new _am.r,e.c=2,e.a=!0,e)};_am.G.a=function(){return _fm.d.a("facebook.png")};_am.G.prototype={S:function(){return 1},e:function(){return _am.G.a()},n:function(){return!1},f:function(){return!0},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!1},j:function(){return!1},h:function(){return"Photos"},o:function(){return!!this.b}};_am.H=function(n,t,i,r,u,f){_am.H.initializeBase(this,[n,t,i,r,u,f]);var e;this.q=(e=new _am.r,e.b=2,e.a=!0,e)};_am.H.a=function(){return _fm.d.a("gdrive.png")};_am.H.prototype={e:function(){return _am.H.a()},n:function(){return!0},f:function(){return this.a.bH.IsThirdPartyProvider},o:function(){return!1},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"Files"}};_am.q=function(n,t,i,r,u,f){_am.q.initializeBase(this,[n,t,i,r,u,f])};_am.q.a=function(){return _fm.d.a("recent-attachments_32x32.png")};_am.q.prototype={e:function(){return _am.q.a()},n:function(){return!1},f:function(){return!1},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"Files"},o:function(){return!1},r:function(){var n=new _gg.D;n.SortColumn=5;n.SortOrder=1;return n},X:function(){var n=new Array(5);n[0]=new _am.m(_ufp.A.W,0);n[1]=new _am.m(_ufp.A.v,2);n[2]=new _am.m(_ufp.A.I,3);n[3]=new _am.m(_ufp.A.BY,4);n[4]=new _am.m(_ufp.A.BX,5);return n}};_am.M=function(n,t,i,r,u,f){_am.M.initializeBase(this,[n,t,i,r,u,f]);var e;this.q=(e=new _am.r,e.b=2,e.a=!0,e)};_am.M.prototype={f:function(){return this.a.bH.IsThirdPartyProvider},o:function(){return this.a.b().b()>1},j:function(){return!this.bx()},l:function(){return!1},U:function(){return!0},g:function(n){this.m(this.be(),n)},h:function(){return this.be()},i:function(){var t=new _j.q;var r=this.C(this.a.b().a(this.a.bH.DefaultScopeIndex));t.c(this.a.b().a(this.a.bH.DefaultScopeIndex));if(r)for(var n=0;n<this.a.b().b();n++){var i=this.C(this.a.b().a(n));if(!i){t.c(this.a.b().a(n));break}}return t},y:function(){var n=this.a.b();if(!n||!n.b())return null;for(var i=new _j.l,t=0;t<n.b();t++)i.a(new _ff.f(n.a(t).DisplayName,n.a(t),this.bf(n.a(t))));return i},bx:function(){return!!this.c()&&this.C(this.c())===4},C:function(n){return n.__type===_gg.md._dataContractName,n.Type},be:function(){var n=this.C(this.c());switch(n){case 4:return"ODCRecentFiles";case 0:return"ODCFiles";default:return"ODCOther"}}};_am.Q=function(n,t,i,r,u,f){_am.Q.initializeBase(this,[n,t,i,r,u,f])};_am.Q.prototype={e:function(){return _fm.a.Z},n:function(){return!0},p:function(){return!0},bf:function(n){var t=_j.h.c("{0} {1}",this.a.bH.DisplayName,n.AriaLabel);return _j.h.c(_ufp.A.BR,t)}};_am.N=function(n,t,i,r,u,f){_am.N.initializeBase(this,[n,t,i,r,u,f]);var e;this.q=(e=new _am.r,e.a=!!u&&u.a().fA().Enabled,e)};_am.N.prototype={j:function(){return!0},h:function(){var n=this.c().Type;switch(n){case 0:return"My files";case 4:return"Recent";case 1:return"Shared with me";case 3:return"Group files"}return"Unknown"},g:function(n){var i=this.c().Type;var t=null;switch(i){case 0:t="AttachmentsFilePickerMyFiles";break;case 4:t="AttachmentsFilePickerRecentFiles";break;case 1:t="AttachmentsFilePickerSharedWithMeFiles";break;case 3:t="AttachmentsFilePickerGroupFiles";break}_j.h.a(t)||this.m(t,n)},K:function(){return _am.a.prototype.K.call(this)&&this.C()},i:function(){var i=new _j.q;var t=this.a.b().a(this.a.bH.DefaultScopeIndex);t.Type!==4&&i.c(t);if(t.Type)for(var n=0;n<this.a.b().b();n++){var r=this.a.b().a(n);if(!r.Type){i.c(r);break}}return i},l:function(){return this.C()},y:function(){var n=this.a.b();if(!n||!n.b())return null;for(var i=new _j.l,t=0;t<n.b();t++)n.a(t).Type!==4&&i.a(new _ff.f(n.a(t).DisplayName,n.a(t),this.bf(n.a(t))));return i},C:function(){return!!this.c()&&this.c().__type===_gg.bU._dataContractName&&!this.c().Type}};_am.S=function(n,t,i,r,u,f){_am.S.initializeBase(this,[n,t,i,r,u,f])};_am.S.prototype={e:function(){return null},n:function(){return!0},f:function(){return!0},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"Files"},o:function(){return!1}};_am.O=function(n,t,i,r,u,f){_am.O.initializeBase(this,[n,t,i,r,u,f])};_am.O.prototype={e:function(){return _am.u.a()}};_am.J=function(n,t,i,r,u,f){_am.J.initializeBase(this,[n,t,i,r,u,f])};_am.J.a=function(){return _fm.d.a("egnyte.png")};_am.J.prototype={e:function(){return _am.J.a()}};_am.k=function(n,t){this.p=Function.createDelegate(this,this.t);this.o=Function.createDelegate(this,this.s);this.q=Function.createDelegate(this,this.v);this.j=Function.createDelegate(this,this.r);_am.k.initializeBase(this);this.c=n;this.i=t;this.d=new _j.g(this.j,_a.a.c);this.h=new _j.g(this.q,_a.a.c);this.f=new _j.g(this.o,_a.a.c);this.g=new _j.g(this.p,_a.a.c)};_am.k.prototype={d:null,c:null,i:null,h:null,f:null,g:null,by:function(){return!this.c.b()||this.c.m()||this.i.b()?0:1},x:function(){return null},a:null,y:function(){return this.a},m:function(n){this.a=n;return n},bA:function(){return!0},b:null,r:function(){this.a&&this.a()},v:function(){this.e(0)},s:function(){this.e(1)},t:function(){this.e(2)},e:function(n){this.b&&this.b(n)}};_am.C.registerClass("_am.C",_a.bv,_fm.m);_am.K.registerClass("_am.K",_fm.g);_am.d.registerClass("_am.d",_at.cc);_am.D.registerClass("_am.D",null,_y.hM);_am.i.registerClass("_am.i",_y.lJ);_am.b.registerClass("_am.b",_a.bv,_y.bQ,_bc.j,_bc.s,_bc.w,_a.kP,_j.bs,Sys.IDisposable,_y.bp);_am.g.registerClass("_am.g",_am.b,_y.B,_bc.w,_a.kP,_j.bs,Sys.IDisposable,_y.ff);_am.n.registerClass("_am.n");AttachmentsFilePickerViewModelsComponent.registerClass("AttachmentsFilePickerViewModelsComponent",null,_a.kd,_j.ce);_am.E.registerClass("_am.E",_a.bv,_y.go,_a.kP,_j.bs,Sys.IDisposable);_am.e.registerClass("_am.e",_y.lJ,_bc.j,_bc.s,_bc.w,_a.kP,_j.bs,Sys.IDisposable);_am.f.registerClass("_am.f",_a.bv);_am.t.registerClass("_am.t",_am.f);_am.l.registerClass("_am.l",_j.l);_am.w.registerClass("_am.w",_am.f);_am.x.registerClass("_am.x",_am.f);_am.y.registerClass("_am.y",_am.f);_am.L.registerClass("_am.L",_am.f);_am.R.registerClass("_am.R",_am.f);_am.A.registerClass("_am.A",_am.R);_am.B.registerClass("_am.B",_am.R);_am.o.registerClass("_am.o",_a.gd);_am.c.registerClass("_am.c",_a.bv,_am.I,_a.kP,_j.bs,Sys.IDisposable);_am.h.registerClass("_am.h",_a.gd);_am.s.registerClass("_am.s",_a.bv);_am.p.registerClass("_am.p",_y.lJ,_bc.j,_bc.s,_bc.w,_a.kP,_j.bs,Sys.IDisposable);_am.j.registerClass("_am.j",_a.bv);_am.a.registerClass("_am.a",_a.bv);_am.u.registerClass("_am.u",_am.a);_am.F.registerClass("_am.F",_am.a);_am.G.registerClass("_am.G",_am.a);_am.H.registerClass("_am.H",_am.a);_am.q.registerClass("_am.q",_am.a);_am.Q.registerClass("_am.Q",_am.a);_am.M.registerClass("_am.M",_am.Q);_am.N.registerClass("_am.N",_am.Q);_am.S.registerClass("_am.S",_am.a);_am.O.registerClass("_am.O",_am.S);_am.J.registerClass("_am.J",_am.S);_am.k.registerClass("_am.k",_y.lJ,_bc.j,_bc.s,_bc.w,_a.kP,_j.bs,Sys.IDisposable);_am.d.a=_a.a.c;AttachmentsFilePickerViewModelsComponent.a=null;AttachmentsFilePickerViewModelsComponent.$$cctor();_am.c.b=new _at.v(null,null,"Search",null,null,null);_am.c.a=null;_am.c.c=null;_am.h.a=_a.a.c;_am.a.b=2;_am.a.c=1;_am.a.a=!1;_am.v.a=_a.a.c;
window.scriptsLoaded['microsoft.owa.attachments.filepicker.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.attachments.filepicker.viewmodels.js'] = (new Date()).getTime();
